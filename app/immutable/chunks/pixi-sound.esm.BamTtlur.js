import{T as x,n as B,e as R,L as I,a as _,i as O}from"./globals.hjIveLDH.js";/*!
 * @pixi/sound - v4.4.1
 * https://github.com/pixijs/pixi-sound
 * Compiled Tue, 15 Aug 2023 19:22:13 UTC
 *
 * @pixi/sound is licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license
 */var C;function l(){return C}var k=function(o,e){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(o,e)};function f(o,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=o}k(o,e),o.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var g=function(){return(g=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(o[i]=e[i]);return o}).apply(this,arguments)},T=["mp3","ogg","oga","opus","mpeg","wav","m4a","aiff","wma","mid","caf"],A={};function K(o){var e=g({m4a:"audio/mp4",oga:"audio/ogg",opus:'audio/ogg; codecs="opus"',caf:'audio/x-caf; codecs="opus"'},o||{}),t=document.createElement("audio"),n={},i=/^no$/;T.forEach(function(r){var s=t.canPlayType("audio/".concat(r)).replace(i,""),u=e[r]?t.canPlayType(e[r]).replace(i,""):"";n[r]=!!s||!!u}),Object.assign(A,n)}K();var q=/\.(\{([^\}]+)\})(\?.*)?$/;function M(o){var e=q,t=typeof o=="string"?o:o.url;if(!e.test(t))return t;for(var n=e.exec(t),i=n[2].split(","),r=i[i.length-1],s=0,u=i.length;s<u;s++){var a=i[s];if(A[a]){r=a;break}}var c=t.replace(n[1],r);if(typeof o!="string"){var p=o;p.extension=r,p.url=c}return c}var w=T.filter(function(o){return A[o]}),E=function(){function o(){}return o.add=function(){o.setLegacy(l().useLegacy)},o.setLegacy=function(e){e?w.forEach(function(t){_.setExtensionXhrType(t,_.XHR_RESPONSE_TYPE.DEFAULT),_.setExtensionLoadType(t,_.LOAD_TYPE.AUDIO)}):w.forEach(function(t){_.setExtensionXhrType(t,_.XHR_RESPONSE_TYPE.BUFFER),_.setExtensionLoadType(t,_.LOAD_TYPE.XHR)})},o.pre=function(e,t){M(e),t()},o.use=function(e,t){e.data&&w.indexOf(e.extension)>-1?e.sound=l().add(e.name,{loaded:t,preload:!0,url:e.url,source:e.data}):t()},o.extension="loader",o}(),D=0,U=function(o){function e(t){var n=o.call(this)||this;return n.id=D++,n.init(t),n}return f(e,o),e.prototype.set=function(t,n){if(this[t]===void 0)throw new Error("Property with name ".concat(t," does not exist."));switch(t){case"speed":this.speed=n;break;case"volume":this.volume=n;break;case"paused":this.paused=n;break;case"loop":this.loop=n;break;case"muted":this.muted=n}return this},Object.defineProperty(e.prototype,"progress",{get:function(){return this._source.currentTime/this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t,this.refreshPaused()},enumerable:!1,configurable:!0}),e.prototype._onPlay=function(){this._playing=!0},e.prototype._onPause=function(){this._playing=!1},e.prototype.init=function(t){this._playing=!1,this._duration=t.source.duration;var n=this._source=t.source.cloneNode(!1);n.src=t.parent.url,n.onplay=this._onPlay.bind(this),n.onpause=this._onPause.bind(this),t.context.on("refresh",this.refresh,this),t.context.on("refreshPaused",this.refreshPaused,this),this._media=t},e.prototype._internalStop=function(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())},e.prototype.stop=function(){this._internalStop(),this._source&&this.emit("stop")},Object.defineProperty(e.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t,this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"filters",{get:function(){return null},set:function(t){},enumerable:!1,configurable:!0}),e.prototype.refresh=function(){var t=this._media.context,n=this._media.parent;this._source.loop=this._loop||n.loop;var i=t.volume*(t.muted?0:1),r=n.volume*(n.muted?0:1),s=this._volume*(this._muted?0:1);this._source.volume=s*i*r,this._source.playbackRate=this._speed*t.speed*n.speed},e.prototype.refreshPaused=function(){var t=this._media.context,n=this._media.parent,i=this._paused||n.paused||t.paused;i!==this._pausedReal&&(this._pausedReal=i,i?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",i))},e.prototype.play=function(t){var n=this,i=t.start,r=t.end,s=t.speed,u=t.loop,a=t.volume,c=t.muted;this._speed=s,this._volume=a,this._loop=!!u,this._muted=c,this.refresh(),this.loop&&r!==null&&(this.loop=!1),this._start=i,this._end=r||this._duration,this._start=Math.max(0,this._start-e.PADDING),this._end=Math.min(this._end+e.PADDING,this._duration),this._source.onloadedmetadata=function(){n._source&&(n._source.currentTime=i,n._source.onloadedmetadata=null,n.emit("progress",i,n._duration),x.shared.add(n._onUpdate,n))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")},e.prototype._onUpdate=function(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()},e.prototype._onComplete=function(){x.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)},e.prototype.destroy=function(){x.shared.remove(this._onUpdate,this),this.removeAllListeners();var t=this._source;t&&(t.onended=null,t.onplay=null,t.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)},e.prototype.toString=function(){return"[HTMLAudioInstance id=".concat(this.id,"]")},e.PADDING=.1,e}(O),V=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return f(e,o),e.prototype.init=function(t){this.parent=t,this._source=t.options.source||new Audio,t.url&&(this._source.src=t.url)},e.prototype.create=function(){return new U(this)},Object.defineProperty(e.prototype,"isPlayable",{get:function(){return!!this._source&&this._source.readyState===4},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._source.duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this.parent.context},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"filters",{get:function(){return null},set:function(t){},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)},Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),e.prototype.load=function(t){var n=this._source,i=this.parent;if(n.readyState!==4)if(i.url){n.src=i.url;var r=function(){a(),i.isLoaded=!0;var p=i.autoPlayStart();t&&t(null,i,p)},s=function(){a(),t&&t(new Error("Sound loading has been aborted"))},u=function(){a();var p="Failed to load audio element (code: ".concat(n.error.code,")");t&&t(new Error(p))},a=function(){n.removeEventListener("canplaythrough",r),n.removeEventListener("load",r),n.removeEventListener("abort",s),n.removeEventListener("error",u)};n.addEventListener("canplaythrough",r,!1),n.addEventListener("load",r,!1),n.addEventListener("abort",s,!1),n.addEventListener("error",u,!1),n.load()}else t(new Error("sound.url or sound.source must be set"));else{i.isLoaded=!0;var c=i.autoPlayStart();t&&setTimeout(function(){t(null,i,c)},0)}},e}(O),N=function(){function o(e,t){this.parent=e,Object.assign(this,t),this.duration=this.end-this.start}return o.prototype.play=function(e){return this.parent.play({complete:e,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})},o.prototype.destroy=function(){this.parent=null},o}(),d=function(){function o(){}return o.setParamValue=function(e,t){if(e.setValueAtTime){var n=l().context;e.setValueAtTime(t,n.audioContext.currentTime)}else e.value=t;return t},o}(),H=0,X=function(o){function e(t){var n=o.call(this)||this;return n.id=H++,n._media=null,n._paused=!1,n._muted=!1,n._elapsed=0,n.init(t),n}return f(e,o),e.prototype.set=function(t,n){if(this[t]===void 0)throw new Error("Property with name ".concat(t," does not exist."));switch(t){case"speed":this.speed=n;break;case"volume":this.volume=n;break;case"muted":this.muted=n;break;case"loop":this.loop=n;break;case"paused":this.paused=n}return this},e.prototype.stop=function(){this._source&&(this._internalStop(),this.emit("stop"))},Object.defineProperty(e.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t,this.refresh(),this._update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"filters",{get:function(){return this._filters},set:function(t){var n;this._filters&&((n=this._filters)===null||n===void 0||n.filter(function(i){return i}).forEach(function(i){return i.disconnect()}),this._filters=null,this._source.connect(this._gain)),this._filters=t!=null&&t.length?t.slice(0):null,this.refresh()},enumerable:!1,configurable:!0}),e.prototype.refresh=function(){if(this._source){var t=this._media.context,n=this._media.parent;this._source.loop=this._loop||n.loop;var i=t.volume*(t.muted?0:1),r=n.volume*(n.muted?0:1),s=this._volume*(this._muted?0:1);d.setParamValue(this._gain.gain,s*r*i),d.setParamValue(this._source.playbackRate,this._speed*n.speed*t.speed),this.applyFilters()}},e.prototype.applyFilters=function(){var t;if(!((t=this._filters)===null||t===void 0)&&t.length){this._source.disconnect();var n=this._source;this._filters.forEach(function(i){n.connect(i.destination),n=i}),n.connect(this._gain)}},e.prototype.refreshPaused=function(){var t=this._media.context,n=this._media.parent,i=this._paused||n.paused||t.paused;i!==this._pausedReal&&(this._pausedReal=i,i?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",i))},e.prototype.play=function(t){var n=t.start,i=t.end,r=t.speed,s=t.loop,u=t.volume,a=t.muted,c=t.filters;this._paused=!1;var p=this._media.nodes.cloneBufferSource(),m=p.source,h=p.gain;this._source=m,this._gain=h,this._speed=r,this._volume=u,this._loop=!!s,this._muted=a,this._filters=c,this.refresh();var b=this._source.buffer.duration;this._duration=b,this._end=i,this._lastUpdate=this._now(),this._elapsed=n,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=i,this._source.loopStart=n,this._source.start(0,n)):i?this._source.start(0,n,i-n):this._source.start(0,n),this.emit("start"),this._update(!0),this.enableTicker(!0)},e.prototype.enableTicker=function(t){x.shared.remove(this._updateListener,this),t&&x.shared.add(this._updateListener,this)},Object.defineProperty(e.prototype,"progress",{get:function(){return this._progress},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t,this.refreshPaused()},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){var t;this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),(t=this._filters)===null||t===void 0||t.forEach(function(n){return n.disconnect()}),this._filters=null,this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1},e.prototype.toString=function(){return"[WebAudioInstance id=".concat(this.id,"]")},e.prototype._now=function(){return this._media.context.audioContext.currentTime},e.prototype._updateListener=function(){this._update()},e.prototype._update=function(t){if(t===void 0&&(t=!1),this._source){var n=this._now(),i=n-this._lastUpdate;if(i>0||t){var r=this._source.playbackRate.value;this._elapsed+=i*r,this._lastUpdate=n;var s=this._duration,u=void 0;if(this._source.loopStart){var a=this._source.loopEnd-this._source.loopStart;u=(this._source.loopStart+this._elapsed%a)/s}else u=this._elapsed%s/s;this._progress=u,this.emit("progress",this._progress,s)}}},e.prototype.init=function(t){this._media=t,t.context.events.on("refresh",this.refresh,this),t.context.events.on("refreshPaused",this.refreshPaused,this)},e.prototype._internalStop=function(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.stop(0),this._source.disconnect();try{this._source.buffer=null}catch{}this._source=null}},e.prototype._onComplete=function(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.disconnect();try{this._source.buffer=null}catch{}}this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)},e}(O),G=function(){function o(e,t){this._output=t,this._input=e}return Object.defineProperty(o.prototype,"destination",{get:function(){return this._input},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"filters",{get:function(){return this._filters},set:function(e){var t=this;if(this._filters&&(this._filters.forEach(function(i){i&&i.disconnect()}),this._filters=null,this._input.connect(this._output)),e&&e.length){this._filters=e.slice(0),this._input.disconnect();var n=null;e.forEach(function(i){n===null?t._input.connect(i.destination):n.connect(i.destination),n=i}),n.connect(this._output)}},enumerable:!1,configurable:!0}),o.prototype.destroy=function(){this.filters=null,this._input=null,this._output=null},o}(),z=function(o){function e(t){var n=this,i=t.audioContext,r=i.createBufferSource(),s=i.createGain(),u=i.createAnalyser();return r.connect(u),u.connect(s),s.connect(t.destination),(n=o.call(this,u,s)||this).context=t,n.bufferSource=r,n.gain=s,n.analyser=u,n}return f(e,o),Object.defineProperty(e.prototype,"script",{get:function(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(e.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){o.prototype.destroy.call(this),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null},e.prototype.cloneBufferSource=function(){var t=this.bufferSource,n=this.context.audioContext.createBufferSource();n.buffer=t.buffer,d.setParamValue(n.playbackRate,t.playbackRate.value),n.loop=t.loop;var i=this.context.audioContext.createGain();return n.connect(i),i.connect(this.destination),{source:n,gain:i}},Object.defineProperty(e.prototype,"bufferSize",{get:function(){return this.script.bufferSize},enumerable:!1,configurable:!0}),e.BUFFER_SIZE=0,e}(G),Y=function(){function o(){}return o.prototype.init=function(e){this.parent=e,this._nodes=new z(this.context),this._source=this._nodes.bufferSource,this.source=e.options.source},o.prototype.destroy=function(){this.parent=null,this._nodes.destroy(),this._nodes=null;try{this._source.buffer=null}catch{}this._source=null,this.source=null},o.prototype.create=function(){return new X(this)},Object.defineProperty(o.prototype,"context",{get:function(){return this.parent.context},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isPlayable",{get:function(){return!!this._source&&!!this._source.buffer},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"filters",{get:function(){return this._nodes.filters},set:function(e){this._nodes.filters=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"duration",{get:function(){return this._source.buffer.duration},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"buffer",{get:function(){return this._source.buffer},set:function(e){this._source.buffer=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"nodes",{get:function(){return this._nodes},enumerable:!1,configurable:!0}),o.prototype.load=function(e){this.source?this._decode(this.source,e):this.parent.url?this._loadUrl(e):e&&e(new Error("sound.url or sound.source must be set"))},o.prototype._loadUrl=function(e){var t=this,n=new XMLHttpRequest,i=this.parent.url;n.open("GET",i,!0),n.responseType="arraybuffer",n.onload=function(){t.source=n.response,t._decode(n.response,e)},n.send()},o.prototype._decode=function(e,t){var n=this,i=function(r,s){if(r)t&&t(r);else{n.parent.isLoaded=!0,n.buffer=s;var u=n.parent.autoPlayStart();t&&t(null,n.parent,u)}};e instanceof AudioBuffer?i(null,e):this.parent.context.decode(e,i)},o}(),L=function(){function o(e,t){this.media=e,this.options=t,this._instances=[],this._sprites={},this.media.init(this);var n=t.complete;this._autoPlayOptions=n?{complete:n}:null,this.isLoaded=!1,this.isPlaying=!1,this.autoPlay=t.autoPlay,this.singleInstance=t.singleInstance,this.preload=t.preload||this.autoPlay,this.url=t.url,this.speed=t.speed,this.volume=t.volume,this.loop=t.loop,t.sprites&&this.addSprites(t.sprites),this.preload&&this._preload(t.loaded)}return o.from=function(e){var t={};return typeof e=="string"?t.url=e:e instanceof ArrayBuffer||e instanceof AudioBuffer||e instanceof HTMLAudioElement?t.source=e:t=e,(t=g({autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1},t)).url&&(t.url=M(t.url)),Object.freeze(t),new o(l().useLegacy?new V:new Y,t)},Object.defineProperty(o.prototype,"context",{get:function(){return l().context},enumerable:!1,configurable:!0}),o.prototype.pause=function(){return this.isPlaying=!1,this.paused=!0,this},o.prototype.resume=function(){return this.isPlaying=this._instances.length>0,this.paused=!1,this},Object.defineProperty(o.prototype,"paused",{get:function(){return this._paused},set:function(e){this._paused=e,this.refreshPaused()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"speed",{get:function(){return this._speed},set:function(e){this._speed=e,this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"filters",{get:function(){return this.media.filters},set:function(e){this.media.filters=e},enumerable:!1,configurable:!0}),o.prototype.addSprites=function(e,t){if(typeof e=="object"){var n={};for(var i in e)n[i]=this.addSprites(i,e[i]);return n}var r=new N(this,t);return this._sprites[e]=r,r},o.prototype.destroy=function(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null},o.prototype.removeSprites=function(e){if(e){var t=this._sprites[e];t!==void 0&&(t.destroy(),delete this._sprites[e])}else for(var n in this._sprites)this.removeSprites(n);return this},Object.defineProperty(o.prototype,"isPlayable",{get:function(){return this.isLoaded&&this.media&&this.media.isPlayable},enumerable:!1,configurable:!0}),o.prototype.stop=function(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(var e=this._instances.length-1;e>=0;e--)this._instances[e].stop();return this},o.prototype.play=function(e,t){var n,i=this;if(typeof e=="string"?n={sprite:s=e,loop:this.loop,complete:t}:typeof e=="function"?(n={}).complete=e:n=e,(n=g({complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1},n||{})).sprite){var r=n.sprite,s=this._sprites[r];n.start=s.start+(n.start||0),n.end=s.end,n.speed=s.speed||1,n.loop=s.loop||n.loop,delete n.sprite}if(n.offset&&(n.start=n.offset),!this.isLoaded)return new Promise(function(a,c){i.autoPlay=!0,i._autoPlayOptions=n,i._preload(function(p,m,h){p?c(p):(n.loaded&&n.loaded(p,m,h),a(h))})});(this.singleInstance||n.singleInstance)&&this._removeInstances();var u=this._createInstance();return this._instances.push(u),this.isPlaying=!0,u.once("end",function(){n.complete&&n.complete(i),i._onComplete(u)}),u.once("stop",function(){i._onComplete(u)}),u.play(n),u},o.prototype.refresh=function(){for(var e=this._instances.length,t=0;t<e;t++)this._instances[t].refresh()},o.prototype.refreshPaused=function(){for(var e=this._instances.length,t=0;t<e;t++)this._instances[t].refreshPaused()},Object.defineProperty(o.prototype,"volume",{get:function(){return this._volume},set:function(e){this._volume=e,this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"muted",{get:function(){return this._muted},set:function(e){this._muted=e,this.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"loop",{get:function(){return this._loop},set:function(e){this._loop=e,this.refresh()},enumerable:!1,configurable:!0}),o.prototype._preload=function(e){this.media.load(e)},Object.defineProperty(o.prototype,"instances",{get:function(){return this._instances},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"sprites",{get:function(){return this._sprites},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"duration",{get:function(){return this.media.duration},enumerable:!1,configurable:!0}),o.prototype.autoPlayStart=function(){var e;return this.autoPlay&&(e=this.play(this._autoPlayOptions)),e},o.prototype._removeInstances=function(){for(var e=this._instances.length-1;e>=0;e--)this._poolInstance(this._instances[e]);this._instances.length=0},o.prototype._onComplete=function(e){if(this._instances){var t=this._instances.indexOf(e);t>-1&&this._instances.splice(t,1),this.isPlaying=this._instances.length>0}this._poolInstance(e)},o.prototype._createInstance=function(){if(o._pool.length>0){var e=o._pool.pop();return e.init(this.media),e}return this.media.create()},o.prototype._poolInstance=function(e){e.destroy(),o._pool.indexOf(e)<0&&o._pool.push(e)},o._pool=[],o}(),W=function(o){function e(){var t=o!==null&&o.apply(this,arguments)||this;return t.speed=1,t.muted=!1,t.volume=1,t.paused=!1,t}return f(e,o),e.prototype.refresh=function(){this.emit("refresh")},e.prototype.refreshPaused=function(){this.emit("refreshPaused")},Object.defineProperty(e.prototype,"filters",{get:function(){return null},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"audioContext",{get:function(){return null},enumerable:!1,configurable:!0}),e.prototype.toggleMute=function(){return this.muted=!this.muted,this.refresh(),this.muted},e.prototype.togglePause=function(){return this.paused=!this.paused,this.refreshPaused(),this.paused},e.prototype.destroy=function(){this.removeAllListeners()},e}(O),S=function(o){function e(){var t=o.call(this,null,null)||this;t.autoPause=!0;var n=window,i=new e.AudioContext,r=i.createDynamicsCompressor(),s=i.createAnalyser();return s.connect(r),r.connect(i.destination),t._input=s,t._output=i.destination,t._ctx=i,t._offlineCtx=new e.OfflineAudioContext(1,2,n.OfflineAudioContext?Math.max(8e3,Math.min(96e3,i.sampleRate)):44100),t.compressor=r,t.analyser=s,t.events=new O,t.volume=1,t.speed=1,t.muted=!1,t.paused=!1,t._locked=i.state==="suspended"&&("ontouchstart"in globalThis||"onclick"in globalThis),t._locked&&(t._unlock(),t._unlock=t._unlock.bind(t),document.addEventListener("mousedown",t._unlock,!0),document.addEventListener("touchstart",t._unlock,!0),document.addEventListener("touchend",t._unlock,!0)),t.onFocus=t.onFocus.bind(t),t.onBlur=t.onBlur.bind(t),globalThis.addEventListener("focus",t.onFocus),globalThis.addEventListener("blur",t.onBlur),t}return f(e,o),e.prototype.onFocus=function(){if(this.autoPause){var t=this._ctx.state;t!=="suspended"&&t!=="interrupted"&&this._locked||(this.paused=this._pausedOnBlur,this.refreshPaused())}},e.prototype.onBlur=function(){this.autoPause&&(this._locked||(this._pausedOnBlur=this._paused,this.paused=!0,this.refreshPaused()))},e.prototype._unlock=function(){this._locked&&(this.playEmptySound(),this._ctx.state==="running"&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._locked=!1))},e.prototype.playEmptySound=function(){var t=this._ctx.createBufferSource();t.buffer=this._ctx.createBuffer(1,1,22050),t.connect(this._ctx.destination),t.start(0,0,0),t.context.state==="suspended"&&t.context.resume()},Object.defineProperty(e,"AudioContext",{get:function(){var t=window;return t.AudioContext||t.webkitAudioContext||null},enumerable:!1,configurable:!0}),Object.defineProperty(e,"OfflineAudioContext",{get:function(){var t=window;return t.OfflineAudioContext||t.webkitOfflineAudioContext||null},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){o.prototype.destroy.call(this);var t=this._ctx;t.close!==void 0&&t.close(),globalThis.removeEventListener("focus",this.onFocus),globalThis.removeEventListener("blur",this.onBlur),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null},Object.defineProperty(e.prototype,"audioContext",{get:function(){return this._ctx},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offlineContext",{get:function(){return this._offlineCtx},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){t&&this._ctx.state==="running"?this._ctx.suspend():t||this._ctx.state!=="suspended"||this._ctx.resume(),this._paused=t},enumerable:!1,configurable:!0}),e.prototype.refresh=function(){this.events.emit("refresh")},e.prototype.refreshPaused=function(){this.events.emit("refreshPaused")},e.prototype.toggleMute=function(){return this.muted=!this.muted,this.refresh(),this.muted},e.prototype.togglePause=function(){return this.paused=!this.paused,this.refreshPaused(),this._paused},e.prototype.decode=function(t,n){var i=function(s){n(new Error((s==null?void 0:s.message)||"Unable to decode file"))},r=this._offlineCtx.decodeAudioData(t,function(s){n(null,s)},i);r&&r.catch(i)},e}(G),Z=function(){function o(){this.init()}return o.prototype.init=function(){return this.supported&&(this._webAudioContext=new S),this._htmlAudioContext=new W,this._sounds={},this.useLegacy=!this.supported,this},Object.defineProperty(o.prototype,"context",{get:function(){return this._context},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"filtersAll",{get:function(){return this.useLegacy?[]:this._context.filters},set:function(e){this.useLegacy||(this._context.filters=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"supported",{get:function(){return S.AudioContext!==null},enumerable:!1,configurable:!0}),o.prototype.add=function(e,t){if(typeof e=="object"){var n={};for(var i in e){var r=this._getOptions(e[i],t);n[i]=this.add(i,r)}return n}if(t instanceof L)return this._sounds[e]=t,t;var s=this._getOptions(t),u=L.from(s);return this._sounds[e]=u,u},o.prototype._getOptions=function(e,t){var n;return n=typeof e=="string"?{url:e}:e instanceof ArrayBuffer||e instanceof AudioBuffer||e instanceof HTMLAudioElement?{source:e}:e,n=g(g({},n),t||{})},Object.defineProperty(o.prototype,"useLegacy",{get:function(){return this._useLegacy},set:function(e){E.setLegacy(e),this._useLegacy=e,this._context=!e&&this.supported?this._webAudioContext:this._htmlAudioContext},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"disableAutoPause",{get:function(){return!this._webAudioContext.autoPause},set:function(e){this._webAudioContext.autoPause=!e},enumerable:!1,configurable:!0}),o.prototype.remove=function(e){return this.exists(e,!0),this._sounds[e].destroy(),delete this._sounds[e],this},Object.defineProperty(o.prototype,"volumeAll",{get:function(){return this._context.volume},set:function(e){this._context.volume=e,this._context.refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"speedAll",{get:function(){return this._context.speed},set:function(e){this._context.speed=e,this._context.refresh()},enumerable:!1,configurable:!0}),o.prototype.togglePauseAll=function(){return this._context.togglePause()},o.prototype.pauseAll=function(){return this._context.paused=!0,this._context.refreshPaused(),this},o.prototype.resumeAll=function(){return this._context.paused=!1,this._context.refreshPaused(),this},o.prototype.toggleMuteAll=function(){return this._context.toggleMute()},o.prototype.muteAll=function(){return this._context.muted=!0,this._context.refresh(),this},o.prototype.unmuteAll=function(){return this._context.muted=!1,this._context.refresh(),this},o.prototype.removeAll=function(){for(var e in this._sounds)this._sounds[e].destroy(),delete this._sounds[e];return this},o.prototype.stopAll=function(){for(var e in this._sounds)this._sounds[e].stop();return this},o.prototype.exists=function(e,t){return!!this._sounds[e]},o.prototype.find=function(e){return this.exists(e,!0),this._sounds[e]},o.prototype.play=function(e,t){return this.find(e).play(t)},o.prototype.stop=function(e){return this.find(e).stop()},o.prototype.pause=function(e){return this.find(e).pause()},o.prototype.resume=function(e){return this.find(e).resume()},o.prototype.volume=function(e,t){var n=this.find(e);return t!==void 0&&(n.volume=t),n.volume},o.prototype.speed=function(e,t){var n=this.find(e);return t!==void 0&&(n.speed=t),n.speed},o.prototype.duration=function(e){return this.find(e).duration},o.prototype.close=function(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this},o}(),y=function(){function o(e,t){this.init(e,t)}return o.prototype.init=function(e,t){this.destination=e,this.source=t||e},o.prototype.connect=function(e){this.source.connect(e)},o.prototype.disconnect=function(){this.source.disconnect()},o.prototype.destroy=function(){this.disconnect(),this.destination=null,this.source=null},o}();(function(o){function e(t,n,i,r,s,u,a,c,p,m){t===void 0&&(t=0),n===void 0&&(n=0),i===void 0&&(i=0),r===void 0&&(r=0),s===void 0&&(s=0),u===void 0&&(u=0),a===void 0&&(a=0),c===void 0&&(c=0),p===void 0&&(p=0),m===void 0&&(m=0);var h=this;if(!l().useLegacy){var b=[{f:e.F32,type:"lowshelf",gain:t},{f:e.F64,type:"peaking",gain:n},{f:e.F125,type:"peaking",gain:i},{f:e.F250,type:"peaking",gain:r},{f:e.F500,type:"peaking",gain:s},{f:e.F1K,type:"peaking",gain:u},{f:e.F2K,type:"peaking",gain:a},{f:e.F4K,type:"peaking",gain:c},{f:e.F8K,type:"peaking",gain:p},{f:e.F16K,type:"highshelf",gain:m}].map(function(F){var P=l().context.audioContext.createBiquadFilter();return P.type=F.type,d.setParamValue(P.Q,1),P.frequency.value=F.f,d.setParamValue(P.gain,F.gain),P});(h=o.call(this,b[0],b[b.length-1])||this).bands=b,h.bandsMap={};for(var v=0;v<h.bands.length;v++){var j=h.bands[v];v>0&&h.bands[v-1].connect(j),h.bandsMap[j.frequency.value]=j}return h}h=o.call(this,null)||this}return f(e,o),e.prototype.setGain=function(t,n){if(n===void 0&&(n=0),!this.bandsMap[t])throw new Error("No band found for frequency ".concat(t));d.setParamValue(this.bandsMap[t].gain,n)},e.prototype.getGain=function(t){if(!this.bandsMap[t])throw new Error("No band found for frequency ".concat(t));return this.bandsMap[t].gain.value},Object.defineProperty(e.prototype,"f32",{get:function(){return this.getGain(e.F32)},set:function(t){this.setGain(e.F32,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f64",{get:function(){return this.getGain(e.F64)},set:function(t){this.setGain(e.F64,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f125",{get:function(){return this.getGain(e.F125)},set:function(t){this.setGain(e.F125,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f250",{get:function(){return this.getGain(e.F250)},set:function(t){this.setGain(e.F250,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f500",{get:function(){return this.getGain(e.F500)},set:function(t){this.setGain(e.F500,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f1k",{get:function(){return this.getGain(e.F1K)},set:function(t){this.setGain(e.F1K,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f2k",{get:function(){return this.getGain(e.F2K)},set:function(t){this.setGain(e.F2K,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f4k",{get:function(){return this.getGain(e.F4K)},set:function(t){this.setGain(e.F4K,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f8k",{get:function(){return this.getGain(e.F8K)},set:function(t){this.setGain(e.F8K,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f16k",{get:function(){return this.getGain(e.F16K)},set:function(t){this.setGain(e.F16K,t)},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.bands.forEach(function(t){d.setParamValue(t.gain,0)})},e.prototype.destroy=function(){this.bands.forEach(function(t){t.disconnect()}),this.bands=null,this.bandsMap=null},e.F32=32,e.F64=64,e.F125=125,e.F250=250,e.F500=500,e.F1K=1e3,e.F2K=2e3,e.F4K=4e3,e.F8K=8e3,e.F16K=16e3,e})(y),function(o){function e(t){t===void 0&&(t=0);var n=this;if(!l().useLegacy){var i=l().context.audioContext.createWaveShaper();return(n=o.call(this,i)||this)._distortion=i,n.amount=t,n}n=o.call(this,null)||this}return f(e,o),Object.defineProperty(e.prototype,"amount",{get:function(){return this._amount},set:function(t){this._amount=t;for(var n,i=1e3*t,r=44100,s=new Float32Array(r),u=Math.PI/180,a=0;a<r;++a)n=2*a/r-1,s[a]=(3+i)*n*20*u/(Math.PI+i*Math.abs(n));this._distortion.curve=s,this._distortion.oversample="4x"},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this._distortion=null,o.prototype.destroy.call(this)},e}(y),function(o){function e(t){t===void 0&&(t=0);var n=this;if(!l().useLegacy){var i,r,s,u=l().context.audioContext;return u.createStereoPanner?s=i=u.createStereoPanner():((r=u.createPanner()).panningModel="equalpower",s=r),(n=o.call(this,s)||this)._stereo=i,n._panner=r,n.pan=t,n}n=o.call(this,null)||this}return f(e,o),Object.defineProperty(e.prototype,"pan",{get:function(){return this._pan},set:function(t){this._pan=t,this._stereo?d.setParamValue(this._stereo.pan,t):this._panner.setPosition(t,0,1-Math.abs(t))},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){o.prototype.destroy.call(this),this._stereo=null,this._panner=null},e}(y),function(o){function e(t,n,i){t===void 0&&(t=3),n===void 0&&(n=2),i===void 0&&(i=!1);var r=this;if(!l().useLegacy)return(r=o.call(this,null)||this)._seconds=r._clamp(t,1,50),r._decay=r._clamp(n,0,100),r._reverse=i,r._rebuild(),r;r=o.call(this,null)||this}return f(e,o),e.prototype._clamp=function(t,n,i){return Math.min(i,Math.max(n,t))},Object.defineProperty(e.prototype,"seconds",{get:function(){return this._seconds},set:function(t){this._seconds=this._clamp(t,1,50),this._rebuild()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"decay",{get:function(){return this._decay},set:function(t){this._decay=this._clamp(t,0,100),this._rebuild()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reverse",{get:function(){return this._reverse},set:function(t){this._reverse=t,this._rebuild()},enumerable:!1,configurable:!0}),e.prototype._rebuild=function(){for(var t,n=l().context.audioContext,i=n.sampleRate,r=i*this._seconds,s=n.createBuffer(2,r,i),u=s.getChannelData(0),a=s.getChannelData(1),c=0;c<r;c++)t=this._reverse?r-c:c,u[c]=(2*Math.random()-1)*Math.pow(1-t/r,this._decay),a[c]=(2*Math.random()-1)*Math.pow(1-t/r,this._decay);var p=l().context.audioContext.createConvolver();p.buffer=s,this.init(p)},e}(y),function(o){function e(){var t=this;if(!l().useLegacy){var n=l().context.audioContext,i=n.createChannelSplitter(),r=n.createChannelMerger();return r.connect(i),(t=o.call(this,r,i)||this)._merger=r,t}t=o.call(this,null)||this}return f(e,o),e.prototype.destroy=function(){this._merger.disconnect(),this._merger=null,o.prototype.destroy.call(this)},e}(y),function(o){function e(){var t=this;if(!l().useLegacy){var n=l().context.audioContext,i=n.createMediaStreamDestination(),r=n.createMediaStreamSource(i.stream);return(t=o.call(this,i,r)||this)._stream=i.stream,t}t=o.call(this,null)||this}return f(e,o),Object.defineProperty(e.prototype,"stream",{get:function(){return this._stream},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this._stream=null,o.prototype.destroy.call(this)},e}(y),function(o){function e(){if(!l().useLegacy){var t=l().context.audioContext,n=t.createBiquadFilter(),i=t.createBiquadFilter(),r=t.createBiquadFilter(),s=t.createBiquadFilter();return n.type="lowpass",d.setParamValue(n.frequency,2e3),i.type="lowpass",d.setParamValue(i.frequency,2e3),r.type="highpass",d.setParamValue(r.frequency,500),s.type="highpass",d.setParamValue(s.frequency,500),n.connect(i),i.connect(r),r.connect(s),o.call(this,n,s)||this}o.call(this,null)}return f(e,o),e}(y);(function(o){return C=o,o})(new Z);"extensions"in B?R.add(E):I.registerPlugin(E);export{y as Filter,G as Filterable,L as Sound,Z as SoundLibrary,E as SoundLoader,N as SoundSprite};
