import{w as Ie,r as lr,g as dr}from"./entry.CFQ_2-8S.js";import{y as en,a0 as wt,a1 as Dn,O as kn,s as $t,e as W,a as ce,c as q,a2 as De,g as fe,b as re,f as F,p as L,i as ie,h as B,V as pr,Q as dt,n as xe,k as _t,R as Ln,a3 as vr,q as Ae,a4 as gn,a5 as Nn,o as gr,v as mr,t as Oe,d as be,j as tt,a6 as mn,a7 as pe}from"./scheduler.DahDdDFs.js";import{a as pt,t as vt,S as Et,i as xt,b as Jt,d as Wt,m as qt,e as Vt}from"./index.BoqX9Pg2.js";function yt(o){return(o==null?void 0:o.length)!==void 0?o:Array.from(o)}function _r(o,n){vt(o,1,1,()=>{n.delete(o.key)})}function Hi(o,n){o.f(),_r(o,n)}function Bi(o,n,t,s,c,f,u,l,d,g,p,_){let y=o.length,b=f.length,S=y;const w={};for(;S--;)w[o[S].key]=S;const $=[],C=new Map,N=new Map,z=[];for(S=b;S--;){const J=_(c,f,S),te=t(J);let T=u.get(te);T?z.push(()=>T.p(J,n)):(T=g(te,J),T.c()),C.set(te,$[S]=T),te in w&&N.set(te,Math.abs(S-w[te]))}const Y=new Set,X=new Set;function de(J){pt(J,1),J.m(l,p),u.set(J.key,J),p=J.first,b--}for(;y&&b;){const J=$[b-1],te=o[y-1],T=J.key,Z=te.key;J===te?(p=J.first,y--,b--):C.has(Z)?!u.has(T)||Y.has(T)?de(J):X.has(Z)?y--:N.get(T)>N.get(Z)?(X.add(T),de(J)):(Y.add(Z),y--):(d(te,u),y--)}for(;y--;){const J=o[y];C.has(J.key)||d(J,u)}for(;b;)de($[b-1]);return en(z),$}const yr=Ie(void 0);function wr(o,n){const{computePosition:t,autoUpdate:s,offset:c,shift:f,flip:u,arrow:l,size:d,autoPlacement:g,hide:p,inline:_}=wt(yr),y={open:!1,autoUpdateCleanup:()=>{}},b=':is(a[href], button, input, textarea, select, details, [tabindex]):not([tabindex="-1"])';let S;const w="https://www.skeleton.dev/utilities/popups";let $,C;function N(){$=document.querySelector(`[data-popup="${n.target}"]`)??document.createElement("div"),C=$.querySelector(".arrow")??document.createElement("div")}N();function z(){var Z,ge,Le,ot,st,Je,We,Q;if(!$)throw new Error(`The data-popup="${n.target}" element was not found. ${w}`);if(!t)throw new Error(`Floating UI 'computePosition' not found for data-popup="${n.target}". ${w}`);if(!c)throw new Error(`Floating UI 'offset' not found for data-popup="${n.target}". ${w}`);if(!f)throw new Error(`Floating UI 'shift' not found for data-popup="${n.target}". ${w}`);if(!u)throw new Error(`Floating UI 'flip' not found for data-popup="${n.target}". ${w}`);if(!l)throw new Error(`Floating UI 'arrow' not found for data-popup="${n.target}". ${w}`);const T=[];d&&T.push(d((Z=n.middleware)==null?void 0:Z.size)),g&&T.push(g((ge=n.middleware)==null?void 0:ge.autoPlacement)),p&&T.push(p((Le=n.middleware)==null?void 0:Le.hide)),_&&T.push(_((ot=n.middleware)==null?void 0:ot.inline)),t(o,$,{placement:n.placement??"bottom",middleware:[c(((st=n.middleware)==null?void 0:st.offset)??8),f(((Je=n.middleware)==null?void 0:Je.shift)??{padding:8}),u((We=n.middleware)==null?void 0:We.flip),l(((Q=n.middleware)==null?void 0:Q.arrow)??{element:C||null}),...T]}).then(({x:at,y:qe,placement:Te,middlewareData:me})=>{if(Object.assign($.style,{left:`${at}px`,top:`${qe}px`}),C){const{x:Ve,y:Ke}=me.arrow,Pt={top:"bottom",right:"left",bottom:"top",left:"right"}[Te.split("-")[0]];Object.assign(C.style,{left:Ve!=null?`${Ve}px`:"",top:Ke!=null?`${Ke}px`:"",right:"",bottom:"",[Pt]:"-4px"})}})}function Y(){$&&(y.open=!0,n.state&&n.state({state:y.open}),z(),$.style.display="block",$.style.opacity="1",$.style.pointerEvents="auto",$.removeAttribute("inert"),y.autoUpdateCleanup=s(o,$,z),S=Array.from($==null?void 0:$.querySelectorAll(b)))}function X(T){if(!$)return;const Z=parseFloat(window.getComputedStyle($).transitionDuration.replace("s",""))*1e3;setTimeout(()=>{y.open=!1,n.state&&n.state({state:y.open}),$.style.opacity="0",$.setAttribute("inert",""),y.autoUpdateCleanup&&y.autoUpdateCleanup(),T&&T()},Z)}function de(){y.open===!1?Y():X()}function J(T){if(y.open===!1||o.contains(T.target))return;if($&&$.contains(T.target)===!1){X();return}const Z=n.closeQuery===void 0?"a[href], button":n.closeQuery;if(Z==="")return;const ge=$==null?void 0:$.querySelectorAll(Z);ge==null||ge.forEach(Le=>{Le.contains(T.target)&&X()})}const te=T=>{if(y.open===!1)return;const Z=T.key;if(Z==="Escape"){T.preventDefault(),o.focus(),X();return}S=Array.from($==null?void 0:$.querySelectorAll(b)),y.open&&document.activeElement===o&&(Z==="ArrowDown"||Z==="Tab")&&b.length>0&&S.length>0&&(T.preventDefault(),S[0].focus())};switch(n.event){case"click":o.addEventListener("click",de,!0),window.addEventListener("click",J,!0);break;case"hover":o.addEventListener("mouseover",Y,!0),o.addEventListener("mouseleave",()=>X(),!0);break;case"focus-blur":o.addEventListener("focus",de,!0),o.addEventListener("blur",()=>X(),!0);break;case"focus-click":o.addEventListener("focus",Y,!0),window.addEventListener("click",J,!0);break;default:throw new Error(`Event value of '${n.event}' is not supported. ${w}`)}return window.addEventListener("keydown",te,!0),z(),{update(T){X(()=>{n=T,z(),N()})},destroy(){o.removeEventListener("click",de,!0),o.removeEventListener("mouseover",Y,!0),o.removeEventListener("mouseleave",()=>X(),!0),o.removeEventListener("focus",de,!0),o.removeEventListener("focus",Y,!0),o.removeEventListener("blur",()=>X(),!0),window.removeEventListener("click",J,!0),window.removeEventListener("keydown",te,!0)}}}const Un="drawerStore";function Fi(){const o=Dn(Un);if(!o)throw new Error("drawerStore is not initialized. Please ensure that `initializeStores()` is invoked in the root layout file of this app!");return o}function Ji(){const o=$r();return kn(Un,o)}function $r(){const{subscribe:o,set:n,update:t}=Ie({});return{subscribe:o,set:n,update:t,open:s=>t(()=>({open:!0,...s})),close:()=>t(s=>(s.open=!1,s))}}const Er={message:"Missing Toast Message",autohide:!0,timeout:5e3},jn="toastStore";function Wi(){const o=Dn(jn);if(!o)throw new Error("toastStore is not initialized. Please ensure that `initializeStores()` is invoked in the root layout file of this app!");return o}function qi(){const o=Ar();return kn(jn,o)}function xr(){const o=Math.random();return Number(o).toString(32)}function Ar(){const{subscribe:o,set:n,update:t}=Ie([]),s=f=>t(u=>{if(u.length>0){const l=u.findIndex(g=>g.id===f),d=u[l];d&&(d.callback&&d.callback({id:f,status:"closed"}),d.timeoutId&&clearTimeout(d.timeoutId),u.splice(l,1))}return u});function c(f){if(f.autohide===!0)return setTimeout(()=>{s(f.id)},f.timeout)}return{subscribe:o,close:s,trigger:f=>{const u=xr();return t(l=>{f&&f.callback&&f.callback({id:u,status:"queued"}),f.hideDismiss&&(f.autohide=!0);const d={...Er,...f,id:u};return d.timeoutId=c(d),l.push(d),l}),u},freeze:f=>t(u=>(u.length>0&&clearTimeout(u[f].timeoutId),u)),unfreeze:f=>t(u=>(u.length>0&&(u[f].timeoutId=c(u[f])),u)),clear:()=>n([])}}const Kt={};function _n(o){return o==="local"?localStorage:sessionStorage}function tn(o,n,t){const s=JSON,c="local";function f(u,l){_n(c).setItem(u,s.stringify(l))}if(!Kt[o]){const u=Ie(n,g=>{const p=_n(c).getItem(o);p&&g(s.parse(p));{const _=y=>{y.key===o&&g(y.newValue?s.parse(y.newValue):null)};return window.addEventListener("storage",_),()=>window.removeEventListener("storage",_)}}),{subscribe:l,set:d}=u;Kt[o]={set(g){f(o,g),d(g)},update(g){const p=g(wt(u));f(o,p),d(p)},subscribe:l}}return Kt[o]}tn("modeOsPrefers",!1);tn("modeUserPrefers",void 0);tn("modeCurrent",!1);const zn="(prefers-reduced-motion: reduce)";function Or(){return window.matchMedia(zn).matches}const Vi=lr(Or(),o=>{{const n=s=>{o(s.matches)},t=window.matchMedia(zn);return t.addEventListener("change",n),()=>{t.removeEventListener("change",n)}}}),yn=Ie(!1);function br(o){let n,t='<p class="text-black">Si tu trouves un bug, contact <span class="text-blue-500">@Pepe</span> sur Onche</p> <div class="arrow bg-white"></div>',s,c,f,u='<button type="button" class="btn-icon btn-icon-sm variant-filled rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128" class="size-6"><g fill="#181616"><path fill-rule="evenodd" clip-rule="evenodd" d="M64 5.103c-33.347 0-60.388 27.035-60.388 60.388 0 26.682 17.303 49.317 41.297 57.303 3.017.56 4.125-1.31 4.125-2.905 0-1.44-.056-6.197-.082-11.243-16.8 3.653-20.345-7.125-20.345-7.125-2.747-6.98-6.705-8.836-6.705-8.836-5.48-3.748.413-3.67.413-3.67 6.063.425 9.257 6.223 9.257 6.223 5.386 9.23 14.127 6.562 17.573 5.02.542-3.903 2.107-6.568 3.834-8.076-13.413-1.525-27.514-6.704-27.514-29.843 0-6.593 2.36-11.98 6.223-16.21-.628-1.52-2.695-7.662.584-15.98 0 0 5.07-1.623 16.61 6.19C53.7 35 58.867 34.327 64 34.304c5.13.023 10.3.694 15.127 2.033 11.526-7.813 16.59-6.19 16.59-6.19 3.287 8.317 1.22 14.46.593 15.98 3.872 4.23 6.215 9.617 6.215 16.21 0 23.194-14.127 28.3-27.574 29.796 2.167 1.874 4.097 5.55 4.097 11.183 0 8.08-.07 14.583-.07 16.572 0 1.607 1.088 3.49 4.148 2.897 23.98-7.994 41.263-30.622 41.263-57.294C124.388 32.14 97.35 5.104 64 5.104z"></path><path d="M26.484 91.806c-.133.3-.605.39-1.035.185-.44-.196-.685-.605-.543-.906.13-.31.603-.395 1.04-.188.44.197.69.61.537.91zm2.446 2.729c-.287.267-.85.143-1.232-.28-.396-.42-.47-.983-.177-1.254.298-.266.844-.14 1.24.28.394.426.472.984.17 1.255zM31.312 98.012c-.37.258-.976.017-1.35-.52-.37-.538-.37-1.183.01-1.44.373-.258.97-.025 1.35.507.368.545.368 1.19-.01 1.452zm3.261 3.361c-.33.365-1.036.267-1.552-.23-.527-.487-.674-1.18-.343-1.544.336-.366 1.045-.264 1.564.23.527.486.686 1.18.333 1.543zm4.5 1.951c-.147.473-.825.688-1.51.486-.683-.207-1.13-.76-.99-1.238.14-.477.823-.7 1.512-.485.683.206 1.13.756.988 1.237zm4.943.361c.017.498-.563.91-1.28.92-.723.017-1.308-.387-1.315-.877 0-.503.568-.91 1.29-.924.717-.013 1.306.387 1.306.88zm4.598-.782c.086.485-.413.984-1.126 1.117-.7.13-1.35-.172-1.44-.653-.086-.498.422-.997 1.122-1.126.714-.123 1.354.17 1.444.663zm0 0"></path></g></svg></button>',l,d,g='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6"><path fill-rule="evenodd" d="M8.478 1.6a.75.75 0 0 1 .273 1.026 3.72 3.72 0 0 0-.425 1.121c.058.058.118.114.18.168A4.491 4.491 0 0 1 12 2.25c1.413 0 2.673.651 3.497 1.668.06-.054.12-.11.178-.167a3.717 3.717 0 0 0-.426-1.125.75.75 0 1 1 1.298-.752 5.22 5.22 0 0 1 .671 2.046.75.75 0 0 1-.187.582c-.241.27-.505.52-.787.749a4.494 4.494 0 0 1 .216 2.1c-.106.792-.753 1.295-1.417 1.403-.182.03-.364.057-.547.081.152.227.273.476.359.742a23.122 23.122 0 0 0 3.832-.803 23.241 23.241 0 0 0-.345-2.634.75.75 0 0 1 1.474-.28c.21 1.115.348 2.256.404 3.418a.75.75 0 0 1-.516.75c-1.527.499-3.119.854-4.76 1.049-.074.38-.22.735-.423 1.05 2.066.209 4.058.672 5.943 1.358a.75.75 0 0 1 .492.75 24.665 24.665 0 0 1-1.189 6.25.75.75 0 0 1-1.425-.47 23.14 23.14 0 0 0 1.077-5.306c-.5-.169-1.009-.32-1.524-.455.068.234.104.484.104.746 0 3.956-2.521 7.5-6 7.5-3.478 0-6-3.544-6-7.5 0-.262.037-.511.104-.746-.514.135-1.022.286-1.522.455.154 1.838.52 3.616 1.077 5.307a.75.75 0 1 1-1.425.468 24.662 24.662 0 0 1-1.19-6.25.75.75 0 0 1 .493-.749 24.586 24.586 0 0 1 4.964-1.24h.01c.321-.046.644-.085.969-.118a2.983 2.983 0 0 1-.424-1.05 24.614 24.614 0 0 1-4.76-1.05.75.75 0 0 1-.516-.75c.057-1.16.194-2.302.405-3.417a.75.75 0 0 1 1.474.28c-.164.862-.28 1.74-.345 2.634 1.237.371 2.517.642 3.832.803.085-.266.207-.515.359-.742a18.698 18.698 0 0 1-.547-.08c-.664-.11-1.311-.612-1.417-1.404a4.535 4.535 0 0 1 .217-2.103 6.788 6.788 0 0 1-.788-.751.75.75 0 0 1-.187-.583 5.22 5.22 0 0 1 .67-2.04.75.75 0 0 1 1.026-.273Z" clip-rule="evenodd"></path></svg>',p,_,y='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6"><path d="M11.25 4.533A9.707 9.707 0 0 0 6 3a9.735 9.735 0 0 0-3.25.555.75.75 0 0 0-.5.707v14.25a.75.75 0 0 0 1 .707A8.237 8.237 0 0 1 6 18.75c1.995 0 3.823.707 5.25 1.886V4.533ZM12.75 20.636A8.214 8.214 0 0 1 18 18.75c.966 0 1.89.166 2.75.47a.75.75 0 0 0 1-.708V4.262a.75.75 0 0 0-.5-.707A9.735 9.735 0 0 0 18 3a9.707 9.707 0 0 0-5.25 1.533v16.103Z"></path></svg>',b,S;return{c(){n=W("div"),n.innerHTML=t,s=ce(),c=W("div"),f=W("a"),f.innerHTML=u,l=ce(),d=W("button"),d.innerHTML=g,p=ce(),_=W("button"),_.innerHTML=y,this.h()},l(w){n=q(w,"DIV",{class:!0,"data-popup":!0,"data-svelte-h":!0}),De(n)!=="svelte-13490m3"&&(n.innerHTML=t),s=fe(w),c=q(w,"DIV",{class:!0});var $=re(c);f=q($,"A",{href:!0,target:!0,class:!0,"data-svelte-h":!0}),De(f)!=="svelte-16q58uj"&&(f.innerHTML=u),l=fe($),d=q($,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),De(d)!=="svelte-w13s7p"&&(d.innerHTML=g),p=fe($),_=q($,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),De(_)!=="svelte-15memu0"&&(_.innerHTML=y),$.forEach(F),this.h()},h(){L(n,"class","p-4 bg-white rounded"),L(n,"data-popup","popupClick"),L(f,"href","https://github.com/Unonche"),L(f,"target","_blank"),L(f,"class","mr-2"),L(d,"type","button"),L(d,"class","btn-icon btn-icon-sm variant-filled rounded-lg mr-2"),L(_,"type","button"),L(_,"class","btn-icon btn-icon-sm variant-filled rounded-lg"),L(c,"class","w-full flex items-center justify-center p-2")},m(w,$){ie(w,n,$),ie(w,s,$),ie(w,c,$),B(c,f),B(c,l),B(c,d),B(c,p),B(c,_),b||(S=[pr(wr.call(null,d,o[1])),dt(_,"click",o[3])],b=!0)},p:xe,i:xe,o:xe,d(w){w&&(F(n),F(s),F(c)),b=!1,en(S)}}}function Sr(o,n,t){let s;_t(o,yn,l=>t(0,s=l));const c={event:"click",target:"popupClick",placement:"bottom"},f=Ln();return[s,c,f,()=>{f("openHelp"),vr(yn,s=!0,s)}]}class Ir extends Et{constructor(n){super(),xt(this,n,Sr,br,$t,{})}}var V=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ki(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function Tr(o){if(o.__esModule)return o;var n=o.default;if(typeof n=="function"){var t=function s(){return this instanceof s?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};t.prototype=n.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(o).forEach(function(s){var c=Object.getOwnPropertyDescriptor(o,s);Object.defineProperty(t,s,c.get?c:{enumerable:!0,get:function(){return o[s]}})}),t}var Hn={};ArrayBuffer.isView||(ArrayBuffer.isView=o=>o!==null&&typeof o=="object"&&o.buffer instanceof ArrayBuffer);typeof globalThis>"u"&&typeof window<"u"&&(window.globalThis=window);var ze={},At={};(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.ServerError=o.CloseCode=void 0,function(t){t[t.CONSENTED=4e3]="CONSENTED",t[t.DEVMODE_RESTART=4010]="DEVMODE_RESTART"}(o.CloseCode||(o.CloseCode={}));class n extends Error{constructor(s,c){super(c),this.name="ServerError",this.code=s}}o.ServerError=n})(At);var nt={},He={};Object.defineProperty(He,"__esModule",{value:!0});He.decode=He.encode=void 0;function Fe(o,n){if(this._offset=n,o instanceof ArrayBuffer)this._buffer=o,this._view=new DataView(this._buffer);else if(ArrayBuffer.isView(o))this._buffer=o.buffer,this._view=new DataView(this._buffer,o.byteOffset,o.byteLength);else throw new Error("Invalid argument")}function Rr(o,n,t){for(var s="",c=0,f=n,u=n+t;f<u;f++){var l=o.getUint8(f);if(!(l&128)){s+=String.fromCharCode(l);continue}if((l&224)===192){s+=String.fromCharCode((l&31)<<6|o.getUint8(++f)&63);continue}if((l&240)===224){s+=String.fromCharCode((l&15)<<12|(o.getUint8(++f)&63)<<6|(o.getUint8(++f)&63)<<0);continue}if((l&248)===240){c=(l&7)<<18|(o.getUint8(++f)&63)<<12|(o.getUint8(++f)&63)<<6|(o.getUint8(++f)&63)<<0,c>=65536?(c-=65536,s+=String.fromCharCode((c>>>10)+55296,(c&1023)+56320)):s+=String.fromCharCode(c);continue}throw new Error("Invalid byte "+l.toString(16))}return s}Fe.prototype._array=function(o){for(var n=new Array(o),t=0;t<o;t++)n[t]=this._parse();return n};Fe.prototype._map=function(o){for(var n="",t={},s=0;s<o;s++)n=this._parse(),t[n]=this._parse();return t};Fe.prototype._str=function(o){var n=Rr(this._view,this._offset,o);return this._offset+=o,n};Fe.prototype._bin=function(o){var n=this._buffer.slice(this._offset,this._offset+o);return this._offset+=o,n};Fe.prototype._parse=function(){var o=this._view.getUint8(this._offset++),n,t=0,s=0,c=0,f=0;if(o<192)return o<128?o:o<144?this._map(o&15):o<160?this._array(o&15):this._str(o&31);if(o>223)return(255-o+1)*-1;switch(o){case 192:return null;case 194:return!1;case 195:return!0;case 196:return t=this._view.getUint8(this._offset),this._offset+=1,this._bin(t);case 197:return t=this._view.getUint16(this._offset),this._offset+=2,this._bin(t);case 198:return t=this._view.getUint32(this._offset),this._offset+=4,this._bin(t);case 199:if(t=this._view.getUint8(this._offset),s=this._view.getInt8(this._offset+1),this._offset+=2,s===-1){var u=this._view.getUint32(this._offset);return c=this._view.getInt32(this._offset+4),f=this._view.getUint32(this._offset+8),this._offset+=12,new Date((c*4294967296+f)*1e3+u/1e6)}return[s,this._bin(t)];case 200:return t=this._view.getUint16(this._offset),s=this._view.getInt8(this._offset+2),this._offset+=3,[s,this._bin(t)];case 201:return t=this._view.getUint32(this._offset),s=this._view.getInt8(this._offset+4),this._offset+=5,[s,this._bin(t)];case 202:return n=this._view.getFloat32(this._offset),this._offset+=4,n;case 203:return n=this._view.getFloat64(this._offset),this._offset+=8,n;case 204:return n=this._view.getUint8(this._offset),this._offset+=1,n;case 205:return n=this._view.getUint16(this._offset),this._offset+=2,n;case 206:return n=this._view.getUint32(this._offset),this._offset+=4,n;case 207:return c=this._view.getUint32(this._offset)*Math.pow(2,32),f=this._view.getUint32(this._offset+4),this._offset+=8,c+f;case 208:return n=this._view.getInt8(this._offset),this._offset+=1,n;case 209:return n=this._view.getInt16(this._offset),this._offset+=2,n;case 210:return n=this._view.getInt32(this._offset),this._offset+=4,n;case 211:return c=this._view.getInt32(this._offset)*Math.pow(2,32),f=this._view.getUint32(this._offset+4),this._offset+=8,c+f;case 212:if(s=this._view.getInt8(this._offset),this._offset+=1,s===0){this._offset+=1;return}return[s,this._bin(1)];case 213:return s=this._view.getInt8(this._offset),this._offset+=1,[s,this._bin(2)];case 214:return s=this._view.getInt8(this._offset),this._offset+=1,s===-1?(n=this._view.getUint32(this._offset),this._offset+=4,new Date(n*1e3)):[s,this._bin(4)];case 215:if(s=this._view.getInt8(this._offset),this._offset+=1,s===0)return c=this._view.getInt32(this._offset)*Math.pow(2,32),f=this._view.getUint32(this._offset+4),this._offset+=8,new Date(c+f);if(s===-1){c=this._view.getUint32(this._offset),f=this._view.getUint32(this._offset+4),this._offset+=8;var l=(c&3)*4294967296+f;return new Date(l*1e3+(c>>>2)/1e6)}return[s,this._bin(8)];case 216:return s=this._view.getInt8(this._offset),this._offset+=1,[s,this._bin(16)];case 217:return t=this._view.getUint8(this._offset),this._offset+=1,this._str(t);case 218:return t=this._view.getUint16(this._offset),this._offset+=2,this._str(t);case 219:return t=this._view.getUint32(this._offset),this._offset+=4,this._str(t);case 220:return t=this._view.getUint16(this._offset),this._offset+=2,this._array(t);case 221:return t=this._view.getUint32(this._offset),this._offset+=4,this._array(t);case 222:return t=this._view.getUint16(this._offset),this._offset+=2,this._map(t);case 223:return t=this._view.getUint32(this._offset),this._offset+=4,this._map(t)}throw new Error("Could not parse")};function Cr(o,n=0){var t=new Fe(o,n),s=t._parse();if(t._offset!==o.byteLength)throw new Error(o.byteLength-t._offset+" trailing bytes");return s}He.decode=Cr;var Mr=4294967296-1,Pr=17179869184-1;function Dr(o,n,t){for(var s=0,c=0,f=t.length;c<f;c++)s=t.charCodeAt(c),s<128?o.setUint8(n++,s):s<2048?(o.setUint8(n++,192|s>>6),o.setUint8(n++,128|s&63)):s<55296||s>=57344?(o.setUint8(n++,224|s>>12),o.setUint8(n++,128|s>>6&63),o.setUint8(n++,128|s&63)):(c++,s=65536+((s&1023)<<10|t.charCodeAt(c)&1023),o.setUint8(n++,240|s>>18),o.setUint8(n++,128|s>>12&63),o.setUint8(n++,128|s>>6&63),o.setUint8(n++,128|s&63))}function kr(o){for(var n=0,t=0,s=0,c=o.length;s<c;s++)n=o.charCodeAt(s),n<128?t+=1:n<2048?t+=2:n<55296||n>=57344?t+=3:(s++,t+=4);return t}function je(o,n,t){var s=typeof t,c=0,f=0,u=0,l=0,d=0,g=0;if(s==="string"){if(d=kr(t),d<32)o.push(d|160),g=1;else if(d<256)o.push(217,d),g=2;else if(d<65536)o.push(218,d>>8,d),g=3;else if(d<4294967296)o.push(219,d>>24,d>>16,d>>8,d),g=5;else throw new Error("String too long");return n.push({_str:t,_length:d,_offset:o.length}),g+d}if(s==="number")return Math.floor(t)!==t||!isFinite(t)?(o.push(203),n.push({_float:t,_length:8,_offset:o.length}),9):t>=0?t<128?(o.push(t),1):t<256?(o.push(204,t),2):t<65536?(o.push(205,t>>8,t),3):t<4294967296?(o.push(206,t>>24,t>>16,t>>8,t),5):(u=t/Math.pow(2,32)>>0,l=t>>>0,o.push(207,u>>24,u>>16,u>>8,u,l>>24,l>>16,l>>8,l),9):t>=-32?(o.push(t),1):t>=-128?(o.push(208,t),2):t>=-32768?(o.push(209,t>>8,t),3):t>=-2147483648?(o.push(210,t>>24,t>>16,t>>8,t),5):(u=Math.floor(t/Math.pow(2,32)),l=t>>>0,o.push(211,u>>24,u>>16,u>>8,u,l>>24,l>>16,l>>8,l),9);if(s==="object"){if(t===null)return o.push(192),1;if(Array.isArray(t)){if(d=t.length,d<16)o.push(d|144),g=1;else if(d<65536)o.push(220,d>>8,d),g=3;else if(d<4294967296)o.push(221,d>>24,d>>16,d>>8,d),g=5;else throw new Error("Array too large");for(c=0;c<d;c++)g+=je(o,n,t[c]);return g}if(t instanceof Date){var p=t.getTime(),_=Math.floor(p/1e3),y=(p-_*1e3)*1e6;return _>=0&&y>=0&&_<=Pr?y===0&&_<=Mr?(o.push(214,255,_>>24,_>>16,_>>8,_),6):(u=_/4294967296,l=_&4294967295,o.push(215,255,y>>22,y>>14,y>>6,u,l>>24,l>>16,l>>8,l),10):(u=Math.floor(_/4294967296),l=_>>>0,o.push(199,12,255,y>>24,y>>16,y>>8,y,u>>24,u>>16,u>>8,u,l>>24,l>>16,l>>8,l),15)}if(t instanceof ArrayBuffer){if(d=t.byteLength,d<256)o.push(196,d),g=2;else if(d<65536)o.push(197,d>>8,d),g=3;else if(d<4294967296)o.push(198,d>>24,d>>16,d>>8,d),g=5;else throw new Error("Buffer too large");return n.push({_bin:t,_length:d,_offset:o.length}),g+d}if(typeof t.toJSON=="function")return je(o,n,t.toJSON());var b=[],S="",w=Object.keys(t);for(c=0,f=w.length;c<f;c++)S=w[c],t[S]!==void 0&&typeof t[S]!="function"&&b.push(S);if(d=b.length,d<16)o.push(d|128),g=1;else if(d<65536)o.push(222,d>>8,d),g=3;else if(d<4294967296)o.push(223,d>>24,d>>16,d>>8,d),g=5;else throw new Error("Object too large");for(c=0;c<d;c++)S=b[c],g+=je(o,n,S),g+=je(o,n,t[S]);return g}if(s==="boolean")return o.push(t?195:194),1;if(s==="undefined")return o.push(192),1;if(typeof t.toJSON=="function")return je(o,n,t.toJSON());throw new Error("Could not encode")}function Lr(o){var n=[],t=[],s=je(n,t,o),c=new ArrayBuffer(s),f=new DataView(c),u=0,l=0,d=-1;t.length>0&&(d=t[0]._offset);for(var g,p=0,_=0,y=0,b=n.length;y<b;y++)if(f.setUint8(l+y,n[y]),y+1===d){if(g=t[u],p=g._length,_=l+d,g._bin)for(var S=new Uint8Array(g._bin),w=0;w<p;w++)f.setUint8(_+w,S[w]);else g._str?Dr(f,_,g._str):g._float!==void 0&&f.setFloat64(_,g._float);u++,l+=p,t[u]&&(d=t[u]._offset)}return c}He.encode=Lr;var Ot={},bt={},Nr=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")},Ur=V&&V.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(bt,"__esModule",{value:!0});bt.WebSocketTransport=void 0;const jr=Ur(Nr),wn=globalThis.WebSocket||jr.default;class zr{constructor(n){this.events=n}send(n){n instanceof ArrayBuffer?this.ws.send(n):Array.isArray(n)&&this.ws.send(new Uint8Array(n).buffer)}connect(n){this.ws=new wn(n,this.protocols),this.ws.binaryType="arraybuffer",this.ws.onopen=this.events.onopen,this.ws.onmessage=this.events.onmessage,this.ws.onclose=this.events.onclose,this.ws.onerror=this.events.onerror}close(n,t){this.ws.close(n,t)}get isOpen(){return this.ws.readyState===wn.OPEN}}bt.WebSocketTransport=zr;Object.defineProperty(Ot,"__esModule",{value:!0});Ot.Connection=void 0;const Hr=bt;class Br{constructor(){this.events={},this.transport=new Hr.WebSocketTransport(this.events)}send(n){this.transport.send(n)}connect(n){this.transport.connect(n)}close(n,t){this.transport.close(n,t)}get isOpen(){return this.transport.isOpen}}Ot.Connection=Br;var nn={};(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.utf8Length=o.utf8Read=o.ErrorCode=o.Protocol=void 0,function(s){s[s.HANDSHAKE=9]="HANDSHAKE",s[s.JOIN_ROOM=10]="JOIN_ROOM",s[s.ERROR=11]="ERROR",s[s.LEAVE_ROOM=12]="LEAVE_ROOM",s[s.ROOM_DATA=13]="ROOM_DATA",s[s.ROOM_STATE=14]="ROOM_STATE",s[s.ROOM_STATE_PATCH=15]="ROOM_STATE_PATCH",s[s.ROOM_DATA_SCHEMA=16]="ROOM_DATA_SCHEMA",s[s.ROOM_DATA_BYTES=17]="ROOM_DATA_BYTES"}(o.Protocol||(o.Protocol={})),function(s){s[s.MATCHMAKE_NO_HANDLER=4210]="MATCHMAKE_NO_HANDLER",s[s.MATCHMAKE_INVALID_CRITERIA=4211]="MATCHMAKE_INVALID_CRITERIA",s[s.MATCHMAKE_INVALID_ROOM_ID=4212]="MATCHMAKE_INVALID_ROOM_ID",s[s.MATCHMAKE_UNHANDLED=4213]="MATCHMAKE_UNHANDLED",s[s.MATCHMAKE_EXPIRED=4214]="MATCHMAKE_EXPIRED",s[s.AUTH_FAILED=4215]="AUTH_FAILED",s[s.APPLICATION_ERROR=4216]="APPLICATION_ERROR"}(o.ErrorCode||(o.ErrorCode={}));function n(s,c){const f=s[c++];for(var u="",l=0,d=c,g=c+f;d<g;d++){var p=s[d];if(!(p&128)){u+=String.fromCharCode(p);continue}if((p&224)===192){u+=String.fromCharCode((p&31)<<6|s[++d]&63);continue}if((p&240)===224){u+=String.fromCharCode((p&15)<<12|(s[++d]&63)<<6|(s[++d]&63)<<0);continue}if((p&248)===240){l=(p&7)<<18|(s[++d]&63)<<12|(s[++d]&63)<<6|(s[++d]&63)<<0,l>=65536?(l-=65536,u+=String.fromCharCode((l>>>10)+55296,(l&1023)+56320)):u+=String.fromCharCode(l);continue}throw new Error("Invalid byte "+p.toString(16))}return u}o.utf8Read=n;function t(s=""){let c=0,f=0;for(let u=0,l=s.length;u<l;u++)c=s.charCodeAt(u),c<128?f+=1:c<2048?f+=2:c<55296||c>=57344?f+=3:(u++,f+=4);return f+1}o.utf8Length=t})(nn);var ke={};Object.defineProperty(ke,"__esModule",{value:!0});ke.getSerializer=ke.registerSerializer=void 0;const Bn={};function Fr(o,n){Bn[o]=n}ke.registerSerializer=Fr;function Jr(o){const n=Bn[o];if(!n)throw new Error("missing serializer: "+o);return n}ke.getSerializer=Jr;var rt={};Object.defineProperty(rt,"__esModule",{value:!0});rt.createNanoEvents=void 0;const Wr=()=>({emit(o,...n){let t=this.events[o]||[];for(let s=0,c=t.length;s<c;s++)t[s](...n)},events:{},on(o,n){var t;return!((t=this.events[o])===null||t===void 0)&&t.push(n)||(this.events[o]=[n]),()=>{var s;this.events[o]=(s=this.events[o])===null||s===void 0?void 0:s.filter(c=>n!==c)}}});rt.createNanoEvents=Wr;var Be={};Object.defineProperty(Be,"__esModule",{value:!0});Be.createSignal=Be.EventEmitter=void 0;class Fn{constructor(){this.handlers=[]}register(n,t=!1){return this.handlers.push(n),this}invoke(...n){this.handlers.forEach(t=>t.apply(this,n))}invokeAsync(...n){return Promise.all(this.handlers.map(t=>t.apply(this,n)))}remove(n){const t=this.handlers.indexOf(n);this.handlers[t]=this.handlers[this.handlers.length-1],this.handlers.pop()}clear(){this.handlers=[]}}Be.EventEmitter=Fn;function qr(){const o=new Fn;function n(t){return o.register(t,this===null)}return n.once=t=>{const s=function(...c){t.apply(this,c),o.remove(s)};o.register(s)},n.remove=t=>o.remove(t),n.invoke=(...t)=>o.invoke(...t),n.invokeAsync=(...t)=>o.invokeAsync(...t),n.clear=()=>o.clear(),n}Be.createSignal=qr;var Gt={exports:{}};(function(o,n){(function(t,s){s(n)})(V,function(t){var s=function(r,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var h in a)Object.prototype.hasOwnProperty.call(a,h)&&(i[h]=a[h])},s(r,e)};function c(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");s(r,e);function i(){this.constructor=r}r.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}function f(r,e,i,a){var h=arguments.length,v=h<3?e:a,x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(r,e,i,a);else for(var E=r.length-1;E>=0;E--)(x=r[E])&&(v=(h<3?x(v):h>3?x(e,i,v):x(e,i))||v);return h>3&&v&&Object.defineProperty(e,i,v),v}function u(r,e,i){if(arguments.length===2)for(var a=0,h=e.length,v;a<h;a++)(v||!(a in e))&&(v||(v=Array.prototype.slice.call(e,0,a)),v[a]=e[a]);return r.concat(v||Array.prototype.slice.call(e))}typeof SuppressedError=="function"&&SuppressedError;var l=255,d=213;t.OPERATION=void 0,function(r){r[r.ADD=128]="ADD",r[r.REPLACE=0]="REPLACE",r[r.DELETE=64]="DELETE",r[r.DELETE_AND_ADD=192]="DELETE_AND_ADD",r[r.TOUCH=1]="TOUCH",r[r.CLEAR=10]="CLEAR"}(t.OPERATION||(t.OPERATION={}));var g=function(){function r(e,i,a){this.changed=!1,this.changes=new Map,this.allChanges=new Set,this.caches={},this.currentCustomOperation=0,this.ref=e,this.setParent(i,a)}return r.prototype.setParent=function(e,i,a){var h=this;if(this.indexes||(this.indexes=this.ref instanceof ue?this.ref._definition.indexes:{}),this.parent=e,this.parentIndex=a,!!i)if(this.root=i,this.ref instanceof ue){var v=this.ref._definition;for(var x in v.schema){var E=this.ref[x];if(E&&E.$changes){var U=v.indexes[x];E.$changes.setParent(this.ref,i,U)}}}else typeof this.ref=="object"&&this.ref.forEach(function(P,A){if(P instanceof ue){var D=P.$changes,O=h.ref.$changes.indexes[A];D.setParent(h.ref,h.root,O)}})},r.prototype.operation=function(e){this.changes.set(--this.currentCustomOperation,e)},r.prototype.change=function(e,i){i===void 0&&(i=t.OPERATION.ADD);var a=typeof e=="number"?e:this.indexes[e];this.assertValidIndex(a,e);var h=this.changes.get(a);(!h||h.op===t.OPERATION.DELETE||h.op===t.OPERATION.TOUCH)&&this.changes.set(a,{op:h&&h.op===t.OPERATION.DELETE?t.OPERATION.DELETE_AND_ADD:i,index:a}),this.allChanges.add(a),this.changed=!0,this.touchParents()},r.prototype.touch=function(e){var i=typeof e=="number"?e:this.indexes[e];this.assertValidIndex(i,e),this.changes.has(i)||this.changes.set(i,{op:t.OPERATION.TOUCH,index:i}),this.allChanges.add(i),this.touchParents()},r.prototype.touchParents=function(){this.parent&&this.parent.$changes.touch(this.parentIndex)},r.prototype.getType=function(e){if(this.ref._definition){var i=this.ref._definition;return i.schema[i.fieldsByIndex[e]]}else{var i=this.parent._definition,a=i.schema[i.fieldsByIndex[this.parentIndex]];return Object.values(a)[0]}},r.prototype.getChildrenFilter=function(){var e=this.parent._definition.childFilters;return e&&e[this.parentIndex]},r.prototype.getValue=function(e){return this.ref.getByIndex(e)},r.prototype.delete=function(e){var i=typeof e=="number"?e:this.indexes[e];if(i===void 0){console.warn("@colyseus/schema ".concat(this.ref.constructor.name,": trying to delete non-existing index: ").concat(e," (").concat(i,")"));return}var a=this.getValue(i);this.changes.set(i,{op:t.OPERATION.DELETE,index:i}),this.allChanges.delete(i),delete this.caches[i],a&&a.$changes&&(a.$changes.parent=void 0),this.changed=!0,this.touchParents()},r.prototype.discard=function(e,i){var a=this;e===void 0&&(e=!1),i===void 0&&(i=!1),this.ref instanceof ue||this.changes.forEach(function(h){if(h.op===t.OPERATION.DELETE){var v=a.ref.getIndex(h.index);delete a.indexes[v]}}),this.changes.clear(),this.changed=e,i&&this.allChanges.clear(),this.currentCustomOperation=0},r.prototype.discardAll=function(){var e=this;this.changes.forEach(function(i){var a=e.getValue(i.index);a&&a.$changes&&a.$changes.discardAll()}),this.discard()},r.prototype.cache=function(e,i){this.caches[e]=i},r.prototype.clone=function(){return new r(this.ref,this.parent,this.root)},r.prototype.ensureRefId=function(){this.refId===void 0&&(this.refId=this.root.getNextUniqueId())},r.prototype.assertValidIndex=function(e,i){if(e===void 0)throw new Error('ChangeTree: missing index for field "'.concat(i,'"'))},r}();function p(r,e,i,a){return r[e]||(r[e]=[]),r[e].push(i),a==null||a.forEach(function(h,v){return i(h,v)}),function(){return y(r[e],r[e].indexOf(i))}}function _(r){var e=this,i=typeof this.$changes.getType()!="string";this.$items.forEach(function(a,h){r.push({refId:e.$changes.refId,op:t.OPERATION.DELETE,field:h,value:void 0,previousValue:a}),i&&e.$changes.root.removeRef(a.$changes.refId)})}function y(r,e){if(e===-1||e>=r.length)return!1;for(var i=r.length-1,a=e;a<i;a++)r[a]=r[a+1];return r.length=i,!0}var b=function(r,e){var i=r.toString(),a=e.toString();return i<a?-1:i>a?1:0};function S(r){return r.$proxy=!0,r=new Proxy(r,{get:function(e,i){return typeof i!="symbol"&&!isNaN(i)?e.at(i):e[i]},set:function(e,i,a){if(typeof i!="symbol"&&!isNaN(i)){var h=Array.from(e.$items.keys()),v=parseInt(h[i]||i);a==null?e.deleteAt(v):e.setAt(v,a)}else e[i]=a;return!0},deleteProperty:function(e,i){return typeof i=="number"?e.deleteAt(i):delete e[i],!0},has:function(e,i){return typeof i!="symbol"&&!isNaN(Number(i))?e.$items.has(Number(i)):Reflect.has(e,i)}}),r}var w=function(){function r(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];this.$changes=new g(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,this.push.apply(this,e)}return r.prototype.onAdd=function(e,i){return i===void 0&&(i=!0),p(this.$callbacks||(this.$callbacks={}),t.OPERATION.ADD,e,i?this.$items:void 0)},r.prototype.onRemove=function(e){return p(this.$callbacks||(this.$callbacks={}),t.OPERATION.DELETE,e)},r.prototype.onChange=function(e){return p(this.$callbacks||(this.$callbacks={}),t.OPERATION.REPLACE,e)},r.is=function(e){return Array.isArray(e)||e.array!==void 0},Object.defineProperty(r.prototype,"length",{get:function(){return this.$items.size},set:function(e){e===0?this.clear():this.splice(e,this.length-e)},enumerable:!1,configurable:!0}),r.prototype.push=function(){for(var e=this,i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var h;return i.forEach(function(v){h=e.$refId++,e.setAt(h,v)}),h},r.prototype.pop=function(){var e=Array.from(this.$indexes.values()).pop();if(e!==void 0){this.$changes.delete(e),this.$indexes.delete(e);var i=this.$items.get(e);return this.$items.delete(e),i}},r.prototype.at=function(e){if(e=Math.trunc(e)||0,e<0&&(e+=this.length),!(e<0||e>=this.length)){var i=Array.from(this.$items.keys())[e];return this.$items.get(i)}},r.prototype.setAt=function(e,i){var a,h;if(i==null){console.error("ArraySchema items cannot be null nor undefined; Use `deleteAt(index)` instead.");return}if(this.$items.get(e)!==i){i.$changes!==void 0&&i.$changes.setParent(this,this.$changes.root,e);var v=(h=(a=this.$changes.indexes[e])===null||a===void 0?void 0:a.op)!==null&&h!==void 0?h:t.OPERATION.ADD;this.$changes.indexes[e]=e,this.$indexes.set(e,e),this.$items.set(e,i),this.$changes.change(e,v)}},r.prototype.deleteAt=function(e){var i=Array.from(this.$items.keys())[e];return i===void 0?!1:this.$deleteAt(i)},r.prototype.$deleteAt=function(e){return this.$changes.delete(e),this.$indexes.delete(e),this.$items.delete(e)},r.prototype.clear=function(e){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),e&&_.call(this,e),this.$items.clear(),this.$changes.operation({index:0,op:t.OPERATION.CLEAR}),this.$changes.touchParents()},r.prototype.concat=function(){for(var e,i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];return new(r.bind.apply(r,u([void 0],(e=Array.from(this.$items.values())).concat.apply(e,i),!1)))},r.prototype.join=function(e){return Array.from(this.$items.values()).join(e)},r.prototype.reverse=function(){var e=this,i=Array.from(this.$items.keys()),a=Array.from(this.$items.values()).reverse();return a.forEach(function(h,v){e.setAt(i[v],h)}),this},r.prototype.shift=function(){var e=Array.from(this.$items.keys()),i=e.shift();if(i!==void 0){var a=this.$items.get(i);return this.$deleteAt(i),a}},r.prototype.slice=function(e,i){var a=new r;return a.push.apply(a,Array.from(this.$items.values()).slice(e,i)),a},r.prototype.sort=function(e){var i=this;e===void 0&&(e=b);var a=Array.from(this.$items.keys()),h=Array.from(this.$items.values()).sort(e);return h.forEach(function(v,x){i.setAt(a[x],v)}),this},r.prototype.splice=function(e,i){i===void 0&&(i=this.length-e);for(var a=[],h=2;h<arguments.length;h++)a[h-2]=arguments[h];for(var v=Array.from(this.$items.keys()),x=[],E=e;E<e+i;E++)x.push(this.$items.get(v[E])),this.$deleteAt(v[E]);for(var E=0;E<a.length;E++)this.setAt(e+E,a[E]);return x},r.prototype.unshift=function(){for(var e=this,i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var h=this.length,v=i.length,x=Array.from(this.$items.values());return i.forEach(function(E,U){e.setAt(U,E)}),x.forEach(function(E,U){e.setAt(v+U,E)}),h+v},r.prototype.indexOf=function(e,i){return Array.from(this.$items.values()).indexOf(e,i)},r.prototype.lastIndexOf=function(e,i){return i===void 0&&(i=this.length-1),Array.from(this.$items.values()).lastIndexOf(e,i)},r.prototype.every=function(e,i){return Array.from(this.$items.values()).every(e,i)},r.prototype.some=function(e,i){return Array.from(this.$items.values()).some(e,i)},r.prototype.forEach=function(e,i){Array.from(this.$items.values()).forEach(e,i)},r.prototype.map=function(e,i){return Array.from(this.$items.values()).map(e,i)},r.prototype.filter=function(e,i){return Array.from(this.$items.values()).filter(e,i)},r.prototype.reduce=function(e,i){return Array.prototype.reduce.apply(Array.from(this.$items.values()),arguments)},r.prototype.reduceRight=function(e,i){return Array.prototype.reduceRight.apply(Array.from(this.$items.values()),arguments)},r.prototype.find=function(e,i){return Array.from(this.$items.values()).find(e,i)},r.prototype.findIndex=function(e,i){return Array.from(this.$items.values()).findIndex(e,i)},r.prototype.fill=function(e,i,a){throw new Error("ArraySchema#fill() not implemented")},r.prototype.copyWithin=function(e,i,a){throw new Error("ArraySchema#copyWithin() not implemented")},r.prototype.toString=function(){return this.$items.toString()},r.prototype.toLocaleString=function(){return this.$items.toLocaleString()},r.prototype[Symbol.iterator]=function(){return Array.from(this.$items.values())[Symbol.iterator]()},Object.defineProperty(r,Symbol.species,{get:function(){return r},enumerable:!1,configurable:!0}),r.prototype.entries=function(){return this.$items.entries()},r.prototype.keys=function(){return this.$items.keys()},r.prototype.values=function(){return this.$items.values()},r.prototype.includes=function(e,i){return Array.from(this.$items.values()).includes(e,i)},r.prototype.flatMap=function(e,i){throw new Error("ArraySchema#flatMap() is not supported.")},r.prototype.flat=function(e){throw new Error("ArraySchema#flat() is not supported.")},r.prototype.findLast=function(){var e=Array.from(this.$items.values());return e.findLast.apply(e,arguments)},r.prototype.findLastIndex=function(){var e=Array.from(this.$items.values());return e.findLastIndex.apply(e,arguments)},r.prototype.with=function(e,i){var a=Array.from(this.$items.values());return a[e]=i,new(r.bind.apply(r,u([void 0],a,!1)))},r.prototype.toReversed=function(){return Array.from(this.$items.values()).reverse()},r.prototype.toSorted=function(e){return Array.from(this.$items.values()).sort(e)},r.prototype.toSpliced=function(e,i){var a=Array.from(this.$items.values());return a.toSpliced.apply(a,arguments)},r.prototype.setIndex=function(e,i){this.$indexes.set(e,i)},r.prototype.getIndex=function(e){return this.$indexes.get(e)},r.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},r.prototype.deleteByIndex=function(e){var i=this.$indexes.get(e);this.$items.delete(i),this.$indexes.delete(e)},r.prototype.toArray=function(){return Array.from(this.$items.values())},r.prototype.toJSON=function(){return this.toArray().map(function(e){return typeof e.toJSON=="function"?e.toJSON():e})},r.prototype.clone=function(e){var i;return e?i=new(r.bind.apply(r,u([void 0],Array.from(this.$items.values()),!1))):i=new(r.bind.apply(r,u([void 0],this.map(function(a){return a.$changes?a.clone():a}),!1))),i},r}();function $(r){return r.$proxy=!0,r=new Proxy(r,{get:function(e,i){return typeof i!="symbol"&&typeof e[i]>"u"?e.get(i):e[i]},set:function(e,i,a){return typeof i!="symbol"&&i.indexOf("$")===-1&&i!=="onAdd"&&i!=="onRemove"&&i!=="onChange"?e.set(i,a):e[i]=a,!0},deleteProperty:function(e,i){return e.delete(i),!0}}),r}var C=function(){function r(e){var i=this;if(this.$changes=new g(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,e)if(e instanceof Map||e instanceof r)e.forEach(function(h,v){return i.set(v,h)});else for(var a in e)this.set(a,e[a])}return r.prototype.onAdd=function(e,i){return i===void 0&&(i=!0),p(this.$callbacks||(this.$callbacks={}),t.OPERATION.ADD,e,i?this.$items:void 0)},r.prototype.onRemove=function(e){return p(this.$callbacks||(this.$callbacks={}),t.OPERATION.DELETE,e)},r.prototype.onChange=function(e){return p(this.$callbacks||(this.$callbacks={}),t.OPERATION.REPLACE,e)},r.is=function(e){return e.map!==void 0},r.prototype[Symbol.iterator]=function(){return this.$items[Symbol.iterator]()},Object.defineProperty(r.prototype,Symbol.toStringTag,{get:function(){return this.$items[Symbol.toStringTag]},enumerable:!1,configurable:!0}),Object.defineProperty(r,Symbol.species,{get:function(){return r},enumerable:!1,configurable:!0}),r.prototype.set=function(e,i){if(i==null)throw new Error("MapSchema#set('".concat(e,"', ").concat(i,"): trying to set ").concat(i," value on '").concat(e,"'."));e=e.toString();var a=typeof this.$changes.indexes[e]<"u",h=a?this.$changes.indexes[e]:this.$refId++,v=a?t.OPERATION.REPLACE:t.OPERATION.ADD,x=i.$changes!==void 0;if(x&&i.$changes.setParent(this,this.$changes.root,h),!a)this.$changes.indexes[e]=h,this.$indexes.set(h,e);else{if(!x&&this.$items.get(e)===i)return;x&&this.$items.get(e)!==i&&(v=t.OPERATION.ADD)}return this.$items.set(e,i),this.$changes.change(e,v),this},r.prototype.get=function(e){return this.$items.get(e)},r.prototype.delete=function(e){return this.$changes.delete(e.toString()),this.$items.delete(e)},r.prototype.clear=function(e){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),e&&_.call(this,e),this.$items.clear(),this.$changes.operation({index:0,op:t.OPERATION.CLEAR}),this.$changes.touchParents()},r.prototype.has=function(e){return this.$items.has(e)},r.prototype.forEach=function(e){this.$items.forEach(e)},r.prototype.entries=function(){return this.$items.entries()},r.prototype.keys=function(){return this.$items.keys()},r.prototype.values=function(){return this.$items.values()},Object.defineProperty(r.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),r.prototype.setIndex=function(e,i){this.$indexes.set(e,i)},r.prototype.getIndex=function(e){return this.$indexes.get(e)},r.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},r.prototype.deleteByIndex=function(e){var i=this.$indexes.get(e);this.$items.delete(i),this.$indexes.delete(e)},r.prototype.toJSON=function(){var e={};return this.forEach(function(i,a){e[a]=typeof i.toJSON=="function"?i.toJSON():i}),e},r.prototype.clone=function(e){var i;return e?i=Object.assign(new r,this):(i=new r,this.forEach(function(a,h){a.$changes?i.set(h,a.clone()):i.set(h,a)})),i},r}(),N={};function z(r,e){N[r]=e}function Y(r){return N[r]}var X=function(){function r(){this.indexes={},this.fieldsByIndex={},this.deprecated={},this.descriptors={}}return r.create=function(e){var i=new r;return i.schema=Object.assign({},e&&e.schema||{}),i.indexes=Object.assign({},e&&e.indexes||{}),i.fieldsByIndex=Object.assign({},e&&e.fieldsByIndex||{}),i.descriptors=Object.assign({},e&&e.descriptors||{}),i.deprecated=Object.assign({},e&&e.deprecated||{}),i},r.prototype.addField=function(e,i){var a=this.getNextFieldIndex();this.fieldsByIndex[a]=e,this.indexes[e]=a,this.schema[e]=Array.isArray(i)?{array:i[0]}:i},r.prototype.hasField=function(e){return this.indexes[e]!==void 0},r.prototype.addFilter=function(e,i){return this.filters||(this.filters={},this.indexesWithFilters=[]),this.filters[this.indexes[e]]=i,this.indexesWithFilters.push(this.indexes[e]),!0},r.prototype.addChildrenFilter=function(e,i){var a=this.indexes[e],h=this.schema[e];if(Y(Object.keys(h)[0]))return this.childFilters||(this.childFilters={}),this.childFilters[a]=i,!0;console.warn("@filterChildren: field '".concat(e,"' can't have children. Ignoring filter."))},r.prototype.getChildrenFilter=function(e){return this.childFilters&&this.childFilters[this.indexes[e]]},r.prototype.getNextFieldIndex=function(){return Object.keys(this.schema||{}).length},r}();function de(r){return r._context&&r._context.useFilters}var J=function(){function r(){this.types={},this.schemas=new Map,this.useFilters=!1}return r.prototype.has=function(e){return this.schemas.has(e)},r.prototype.get=function(e){return this.types[e]},r.prototype.add=function(e,i){i===void 0&&(i=this.schemas.size),e._definition=X.create(e._definition),e._typeid=i,this.types[i]=e,this.schemas.set(e,i)},r.create=function(e){return e===void 0&&(e={}),function(i){return e.context||(e.context=new r),T(i,e)}},r}(),te=new J;function T(r,e){return e===void 0&&(e={}),function(i,a){var h=e.context||te,v=i.constructor;if(v._context=h,!r)throw new Error("".concat(v.name,': @type() reference provided for "').concat(a,`" is undefined. Make sure you don't have any circular dependencies.`));h.has(v)||h.add(v);var x=v._definition;if(x.addField(a,r),x.descriptors[a]){if(x.deprecated[a])return;try{throw new Error("@colyseus/schema: Duplicate '".concat(a,"' definition on '").concat(v.name,`'.
Check @type() annotation`))}catch(O){var E=O.stack.split(`
`)[4].trim();throw new Error("".concat(O.message," ").concat(E))}}var U=w.is(r),P=!U&&C.is(r);if(typeof r!="string"&&!ue.is(r)){var A=Object.values(r)[0];typeof A!="string"&&!h.has(A)&&h.add(A)}if(e.manual){x.descriptors[a]={enumerable:!0,configurable:!0,writable:!0};return}var D="_".concat(a);x.descriptors[D]={enumerable:!1,configurable:!1,writable:!0},x.descriptors[a]={get:function(){return this[D]},set:function(O){O!==this[D]&&(O!=null?(U&&!(O instanceof w)&&(O=new(w.bind.apply(w,u([void 0],O,!1)))),P&&!(O instanceof C)&&(O=new C(O)),O.$proxy===void 0&&(P?O=$(O):U&&(O=S(O))),this.$changes.change(a),O.$changes&&O.$changes.setParent(this,this.$changes.root,this._definition.indexes[a])):this[D]&&this.$changes.delete(a),this[D]=O)},enumerable:!0,configurable:!0}}}function Z(r){return function(e,i){var a=e.constructor,h=a._definition;h.addFilter(i,r)&&(a._context.useFilters=!0)}}function ge(r){return function(e,i){var a=e.constructor,h=a._definition;h.addChildrenFilter(i,r)&&(a._context.useFilters=!0)}}function Le(r){return r===void 0&&(r=!0),function(e,i){var a=e.constructor,h=a._definition;h.deprecated[i]=!0,r&&(h.descriptors[i]={get:function(){throw new Error("".concat(i," is deprecated."))},set:function(v){},enumerable:!1,configurable:!0})}}function ot(r,e,i){i===void 0&&(i={}),i.context||(i.context=r._context||i.context||te);for(var a in e)T(e[a],i)(r.prototype,a);return r}function st(r){for(var e=0,i=0,a=0,h=r.length;a<h;a++)e=r.charCodeAt(a),e<128?i+=1:e<2048?i+=2:e<55296||e>=57344?i+=3:(a++,i+=4);return i}function Je(r,e,i){for(var a=0,h=0,v=i.length;h<v;h++)a=i.charCodeAt(h),a<128?r[e++]=a:a<2048?(r[e++]=192|a>>6,r[e++]=128|a&63):a<55296||a>=57344?(r[e++]=224|a>>12,r[e++]=128|a>>6&63,r[e++]=128|a&63):(h++,a=65536+((a&1023)<<10|i.charCodeAt(h)&1023),r[e++]=240|a>>18,r[e++]=128|a>>12&63,r[e++]=128|a>>6&63,r[e++]=128|a&63)}function We(r,e){r.push(e&255)}function Q(r,e){r.push(e&255)}function at(r,e){r.push(e&255),r.push(e>>8&255)}function qe(r,e){r.push(e&255),r.push(e>>8&255)}function Te(r,e){r.push(e&255),r.push(e>>8&255),r.push(e>>16&255),r.push(e>>24&255)}function me(r,e){var i=e>>24,a=e>>16,h=e>>8,v=e;r.push(v&255),r.push(h&255),r.push(a&255),r.push(i&255)}function Ve(r,e){var i=Math.floor(e/Math.pow(2,32)),a=e>>>0;me(r,a),me(r,i)}function Ke(r,e){var i=e/Math.pow(2,32)>>0,a=e>>>0;me(r,a),me(r,i)}function Pt(r,e){an(r,e)}function qn(r,e){Dt(r,e)}var Ye=new Int32Array(2),Vn=new Float32Array(Ye.buffer),Kn=new Float64Array(Ye.buffer);function an(r,e){Vn[0]=e,Te(r,Ye[0])}function Dt(r,e){Kn[0]=e,Te(r,Ye[0]),Te(r,Ye[1])}function Yn(r,e){return Q(r,e?1:0)}function ct(r,e){e||(e="");var i=st(e),a=0;if(i<32)r.push(i|160),a=1;else if(i<256)r.push(217),Q(r,i),a=2;else if(i<65536)r.push(218),qe(r,i),a=3;else if(i<4294967296)r.push(219),me(r,i),a=5;else throw new Error("String too long");return Je(r,r.length,e),a+i}function oe(r,e){if(isNaN(e))return oe(r,0);if(isFinite(e)){if(e!==(e|0))return r.push(203),Dt(r,e),9}else return oe(r,e>0?Number.MAX_SAFE_INTEGER:-Number.MAX_SAFE_INTEGER);return e>=0?e<128?(Q(r,e),1):e<256?(r.push(204),Q(r,e),2):e<65536?(r.push(205),qe(r,e),3):e<4294967296?(r.push(206),me(r,e),5):(r.push(207),Ke(r,e),9):e>=-32?(r.push(224|e+32),1):e>=-128?(r.push(208),We(r,e),2):e>=-32768?(r.push(209),at(r,e),3):e>=-2147483648?(r.push(210),Te(r,e),5):(r.push(211),Ve(r,e),9)}var kt=Object.freeze({__proto__:null,boolean:Yn,float32:Pt,float64:qn,int16:at,int32:Te,int64:Ve,int8:We,number:oe,string:ct,uint16:qe,uint32:me,uint64:Ke,uint8:Q,utf8Write:Je,writeFloat32:an,writeFloat64:Dt});function Xn(r,e,i){for(var a="",h=0,v=e,x=e+i;v<x;v++){var E=r[v];if(!(E&128)){a+=String.fromCharCode(E);continue}if((E&224)===192){a+=String.fromCharCode((E&31)<<6|r[++v]&63);continue}if((E&240)===224){a+=String.fromCharCode((E&15)<<12|(r[++v]&63)<<6|(r[++v]&63)<<0);continue}if((E&248)===240){h=(E&7)<<18|(r[++v]&63)<<12|(r[++v]&63)<<6|(r[++v]&63)<<0,h>=65536?(h-=65536,a+=String.fromCharCode((h>>>10)+55296,(h&1023)+56320)):a+=String.fromCharCode(h);continue}console.error("Invalid byte "+E.toString(16))}return a}function cn(r,e){return Xe(r,e)<<24>>24}function Xe(r,e){return r[e.offset++]}function fn(r,e){return ft(r,e)<<16>>16}function ft(r,e){return r[e.offset++]|r[e.offset++]<<8}function Re(r,e){return r[e.offset++]|r[e.offset++]<<8|r[e.offset++]<<16|r[e.offset++]<<24}function Ne(r,e){return Re(r,e)>>>0}function Gn(r,e){return Lt(r,e)}function Zn(r,e){return Nt(r,e)}function un(r,e){var i=Ne(r,e),a=Re(r,e)*Math.pow(2,32);return a+i}function hn(r,e){var i=Ne(r,e),a=Ne(r,e)*Math.pow(2,32);return a+i}var Ge=new Int32Array(2),Qn=new Float32Array(Ge.buffer),er=new Float64Array(Ge.buffer);function Lt(r,e){return Ge[0]=Re(r,e),Qn[0]}function Nt(r,e){return Ge[0]=Re(r,e),Ge[1]=Re(r,e),er[0]}function tr(r,e){return Xe(r,e)>0}function ln(r,e){var i=r[e.offset++],a;i<192?a=i&31:i===217?a=Xe(r,e):i===218?a=ft(r,e):i===219&&(a=Ne(r,e));var h=Xn(r,e.offset,a);return e.offset+=a,h}function nr(r,e){var i=r[e.offset];return i<192&&i>160||i===217||i===218||i===219}function Ce(r,e){var i=r[e.offset++];if(i<128)return i;if(i===202)return Lt(r,e);if(i===203)return Nt(r,e);if(i===204)return Xe(r,e);if(i===205)return ft(r,e);if(i===206)return Ne(r,e);if(i===207)return hn(r,e);if(i===208)return cn(r,e);if(i===209)return fn(r,e);if(i===210)return Re(r,e);if(i===211)return un(r,e);if(i>223)return(255-i+1)*-1}function rr(r,e){var i=r[e.offset];return i<128||i>=202&&i<=211}function ir(r,e){return r[e.offset]<160}function dn(r,e){return r[e.offset-1]===l&&(r[e.offset]<128||r[e.offset]>=202&&r[e.offset]<=211)}var pn=Object.freeze({__proto__:null,arrayCheck:ir,boolean:tr,float32:Gn,float64:Zn,int16:fn,int32:Re,int64:un,int8:cn,number:Ce,numberCheck:rr,readFloat32:Lt,readFloat64:Nt,string:ln,stringCheck:nr,switchStructureCheck:dn,uint16:ft,uint32:Ne,uint64:hn,uint8:Xe}),Ut=function(){function r(e){var i=this;this.$changes=new g(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,e&&e.forEach(function(a){return i.add(a)})}return r.prototype.onAdd=function(e,i){return i===void 0&&(i=!0),p(this.$callbacks||(this.$callbacks=[]),t.OPERATION.ADD,e,i?this.$items:void 0)},r.prototype.onRemove=function(e){return p(this.$callbacks||(this.$callbacks=[]),t.OPERATION.DELETE,e)},r.prototype.onChange=function(e){return p(this.$callbacks||(this.$callbacks=[]),t.OPERATION.REPLACE,e)},r.is=function(e){return e.collection!==void 0},r.prototype.add=function(e){var i=this.$refId++,a=e.$changes!==void 0;return a&&e.$changes.setParent(this,this.$changes.root,i),this.$changes.indexes[i]=i,this.$indexes.set(i,i),this.$items.set(i,e),this.$changes.change(i),i},r.prototype.at=function(e){var i=Array.from(this.$items.keys())[e];return this.$items.get(i)},r.prototype.entries=function(){return this.$items.entries()},r.prototype.delete=function(e){for(var i=this.$items.entries(),a,h;(h=i.next())&&!h.done;)if(e===h.value[1]){a=h.value[0];break}return a===void 0?!1:(this.$changes.delete(a),this.$indexes.delete(a),this.$items.delete(a))},r.prototype.clear=function(e){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),e&&_.call(this,e),this.$items.clear(),this.$changes.operation({index:0,op:t.OPERATION.CLEAR}),this.$changes.touchParents()},r.prototype.has=function(e){return Array.from(this.$items.values()).some(function(i){return i===e})},r.prototype.forEach=function(e){var i=this;this.$items.forEach(function(a,h,v){return e(a,h,i)})},r.prototype.values=function(){return this.$items.values()},Object.defineProperty(r.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),r.prototype.setIndex=function(e,i){this.$indexes.set(e,i)},r.prototype.getIndex=function(e){return this.$indexes.get(e)},r.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},r.prototype.deleteByIndex=function(e){var i=this.$indexes.get(e);this.$items.delete(i),this.$indexes.delete(e)},r.prototype.toArray=function(){return Array.from(this.$items.values())},r.prototype.toJSON=function(){var e=[];return this.forEach(function(i,a){e.push(typeof i.toJSON=="function"?i.toJSON():i)}),e},r.prototype.clone=function(e){var i;return e?i=Object.assign(new r,this):(i=new r,this.forEach(function(a){a.$changes?i.add(a.clone()):i.add(a)})),i},r}(),jt=function(){function r(e){var i=this;this.$changes=new g(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,e&&e.forEach(function(a){return i.add(a)})}return r.prototype.onAdd=function(e,i){return i===void 0&&(i=!0),p(this.$callbacks||(this.$callbacks=[]),t.OPERATION.ADD,e,i?this.$items:void 0)},r.prototype.onRemove=function(e){return p(this.$callbacks||(this.$callbacks=[]),t.OPERATION.DELETE,e)},r.prototype.onChange=function(e){return p(this.$callbacks||(this.$callbacks=[]),t.OPERATION.REPLACE,e)},r.is=function(e){return e.set!==void 0},r.prototype.add=function(e){var i,a;if(this.has(e))return!1;var h=this.$refId++;e.$changes!==void 0&&e.$changes.setParent(this,this.$changes.root,h);var v=(a=(i=this.$changes.indexes[h])===null||i===void 0?void 0:i.op)!==null&&a!==void 0?a:t.OPERATION.ADD;return this.$changes.indexes[h]=h,this.$indexes.set(h,h),this.$items.set(h,e),this.$changes.change(h,v),h},r.prototype.entries=function(){return this.$items.entries()},r.prototype.delete=function(e){for(var i=this.$items.entries(),a,h;(h=i.next())&&!h.done;)if(e===h.value[1]){a=h.value[0];break}return a===void 0?!1:(this.$changes.delete(a),this.$indexes.delete(a),this.$items.delete(a))},r.prototype.clear=function(e){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),e&&_.call(this,e),this.$items.clear(),this.$changes.operation({index:0,op:t.OPERATION.CLEAR}),this.$changes.touchParents()},r.prototype.has=function(e){for(var i=this.$items.values(),a=!1,h;(h=i.next())&&!h.done;)if(e===h.value){a=!0;break}return a},r.prototype.forEach=function(e){var i=this;this.$items.forEach(function(a,h,v){return e(a,h,i)})},r.prototype.values=function(){return this.$items.values()},Object.defineProperty(r.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),r.prototype.setIndex=function(e,i){this.$indexes.set(e,i)},r.prototype.getIndex=function(e){return this.$indexes.get(e)},r.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},r.prototype.deleteByIndex=function(e){var i=this.$indexes.get(e);this.$items.delete(i),this.$indexes.delete(e)},r.prototype.toArray=function(){return Array.from(this.$items.values())},r.prototype.toJSON=function(){var e=[];return this.forEach(function(i,a){e.push(typeof i.toJSON=="function"?i.toJSON():i)}),e},r.prototype.clone=function(e){var i;return e?i=Object.assign(new r,this):(i=new r,this.forEach(function(a){a.$changes?i.add(a.clone()):i.add(a)})),i},r}(),or=function(){function r(){this.refIds=new WeakSet,this.containerIndexes=new WeakMap}return r.prototype.addRefId=function(e){this.refIds.has(e)||(this.refIds.add(e),this.containerIndexes.set(e,new Set))},r.get=function(e){return e.$filterState===void 0&&(e.$filterState=new r),e.$filterState},r}(),sr=function(){function r(){this.refs=new Map,this.refCounts={},this.deletedRefs=new Set,this.nextUniqueId=0}return r.prototype.getNextUniqueId=function(){return this.nextUniqueId++},r.prototype.addRef=function(e,i,a){a===void 0&&(a=!0),this.refs.set(e,i),a&&(this.refCounts[e]=(this.refCounts[e]||0)+1)},r.prototype.removeRef=function(e){var i=this.refCounts[e];if(i===void 0){console.warn("trying to remove reference ".concat(e," that doesn't exist"));return}if(i===0){console.warn("trying to remove reference ".concat(e," with 0 refCount"));return}this.refCounts[e]=i-1,this.deletedRefs.add(e)},r.prototype.clearRefs=function(){this.refs.clear(),this.deletedRefs.clear(),this.refCounts={}},r.prototype.garbageCollectDeletedRefs=function(){var e=this;this.deletedRefs.forEach(function(i){if(!(e.refCounts[i]>0)){var a=e.refs.get(i);if(a instanceof ue)for(var h in a._definition.schema)typeof a._definition.schema[h]!="string"&&a[h]&&a[h].$changes&&e.removeRef(a[h].$changes.refId);else{var v=a.$changes.parent._definition,x=v.schema[v.fieldsByIndex[a.$changes.parentIndex]];typeof Object.values(x)[0]=="function"&&Array.from(a.values()).forEach(function(E){return e.removeRef(E.$changes.refId)})}e.refs.delete(i),delete e.refCounts[i]}}),this.deletedRefs.clear()},r}(),zt=function(r){c(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e}(Error);function ar(r,e,i,a){var h,v=!1;switch(e){case"number":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":case"int64":case"uint64":case"float32":case"float64":h="number",isNaN(r)&&console.log('trying to encode "NaN" in '.concat(i.constructor.name,"#").concat(a));break;case"string":h="string",v=!0;break;case"boolean":return}if(typeof r!==h&&(!v||v&&r!==null)){var x="'".concat(JSON.stringify(r),"'").concat(r&&r.constructor&&" (".concat(r.constructor.name,")")||"");throw new zt("a '".concat(h,"' was expected, but ").concat(x," was provided in ").concat(i.constructor.name,"#").concat(a))}}function vn(r,e,i,a){if(!(r instanceof e))throw new zt("a '".concat(e.name,"' was expected, but '").concat(r.constructor.name,"' was provided in ").concat(i.constructor.name,"#").concat(a))}function cr(r,e,i,a,h){ar(i,r,a,h);var v=kt[r];if(v)v(e,i);else throw new zt("a '".concat(r,"' was expected, but ").concat(i," was provided in ").concat(a.constructor.name,"#").concat(h))}function fr(r,e,i){return pn[r](e,i)}var ue=function(){function r(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];Object.defineProperties(this,{$changes:{value:new g(this,void 0,new sr),enumerable:!1,writable:!0},$callbacks:{value:void 0,enumerable:!1,writable:!0}});var a=this._definition.descriptors;a&&Object.defineProperties(this,a),e[0]&&this.assign(e[0])}return r.onError=function(e){console.error(e)},r.is=function(e){return e._definition&&e._definition.schema!==void 0},r.prototype.onChange=function(e){return p(this.$callbacks||(this.$callbacks={}),t.OPERATION.REPLACE,e)},r.prototype.onRemove=function(e){return p(this.$callbacks||(this.$callbacks={}),t.OPERATION.DELETE,e)},r.prototype.assign=function(e){return Object.assign(this,e),this},Object.defineProperty(r.prototype,"_definition",{get:function(){return this.constructor._definition},enumerable:!1,configurable:!0}),r.prototype.setDirty=function(e,i){this.$changes.change(e,i)},r.prototype.listen=function(e,i,a){var h=this;return a===void 0&&(a=!0),this.$callbacks||(this.$callbacks={}),this.$callbacks[e]||(this.$callbacks[e]=[]),this.$callbacks[e].push(i),a&&this[e]!==void 0&&i(this[e],void 0),function(){return y(h.$callbacks[e],h.$callbacks[e].indexOf(i))}},r.prototype.decode=function(e,i,a){i===void 0&&(i={offset:0}),a===void 0&&(a=this);var h=[],v=this.$changes.root,x=e.length,E=0;for(v.refs.set(E,this);i.offset<x;){var U=e[i.offset++];if(U==l){E=Ce(e,i);var P=v.refs.get(E);if(!P)throw new Error('"refId" not found: '.concat(E));a=P;continue}var A=a.$changes,D=a._definition!==void 0,O=D?U>>6<<6:U;if(O===t.OPERATION.CLEAR){a.clear(h);continue}var M=D?U%(O||255):Ce(e,i),I=D?a._definition.fieldsByIndex[M]:"",R=A.getType(M),m=void 0,j=void 0,se=void 0;if(D?j=a["_".concat(I)]:(j=a.getByIndex(M),(O&t.OPERATION.ADD)===t.OPERATION.ADD?(se=a instanceof C?ln(e,i):M,a.setIndex(M,se)):se=a.getIndex(M)),(O&t.OPERATION.DELETE)===t.OPERATION.DELETE&&(O!==t.OPERATION.DELETE_AND_ADD&&a.deleteByIndex(M),j&&j.$changes&&v.removeRef(j.$changes.refId),m=null),I===void 0){console.warn("@colyseus/schema: definition mismatch");for(var K={offset:i.offset};i.offset<x&&!(dn(e,i)&&(K.offset=i.offset+1,v.refs.has(Ce(e,K))));)i.offset++;continue}else if(O!==t.OPERATION.DELETE)if(r.is(R)){var k=Ce(e,i);if(m=v.refs.get(k),O!==t.OPERATION.REPLACE){var H=this.getSchemaType(e,i,R);m||(m=this.createTypeInstance(H),m.$changes.refId=k,j&&(m.$callbacks=j.$callbacks,j.$changes.refId&&k!==j.$changes.refId&&v.removeRef(j.$changes.refId))),v.addRef(k,m,m!==j)}}else if(typeof R=="string")m=fr(R,e,i);else{var ye=Y(Object.keys(R)[0]),we=Ce(e,i),he=v.refs.has(we)?j||v.refs.get(we):new ye.constructor;if(m=he.clone(!0),m.$changes.refId=we,j&&(m.$callbacks=j.$callbacks,j.$changes.refId&&we!==j.$changes.refId)){v.removeRef(j.$changes.refId);for(var ee=j.entries(),G=void 0;(G=ee.next())&&!G.done;){var ut=G.value,_e=ut[0],Ft=ut[1];h.push({refId:we,op:t.OPERATION.DELETE,field:_e,value:void 0,previousValue:Ft})}}v.addRef(we,m,he!==j)}if(m!=null){if(m.$changes&&m.$changes.setParent(A.ref,A.root,M),a instanceof r)a[I]=m;else if(a instanceof C){var _e=se;a.$items.set(_e,m),a.$changes.allChanges.add(M)}else if(a instanceof w)a.setAt(M,m);else if(a instanceof Ut){var $e=a.add(m);a.setIndex(M,$e)}else if(a instanceof jt){var $e=a.add(m);$e!==!1&&a.setIndex(M,$e)}}j!==m&&h.push({refId:E,op:O,field:I,dynamicIndex:se,value:m,previousValue:j})}return this._triggerChanges(h),v.garbageCollectDeletedRefs(),h},r.prototype.encode=function(e,i,a){e===void 0&&(e=!1),i===void 0&&(i=[]),a===void 0&&(a=!1);for(var h=this.$changes,v=new WeakSet,x=[h],E=1,U=0;U<E;U++){var P=x[U],A=P.ref,D=A instanceof r;P.ensureRefId(),v.add(P),P!==h&&(P.changed||e)&&(Q(i,l),oe(i,P.refId));for(var O=e?Array.from(P.allChanges):Array.from(P.changes.values()),M=0,I=O.length;M<I;M++){var R=e?{op:t.OPERATION.ADD,index:O[M]}:O[M],m=R.index,j=D?A._definition.fieldsByIndex&&A._definition.fieldsByIndex[m]:m,se=i.length;if(R.op!==t.OPERATION.TOUCH)if(D)Q(i,m|R.op);else{if(Q(i,R.op),R.op===t.OPERATION.CLEAR)continue;oe(i,m)}if(!D&&(R.op&t.OPERATION.ADD)==t.OPERATION.ADD&&A instanceof C){var K=P.ref.$indexes.get(m);ct(i,K)}if(R.op!==t.OPERATION.DELETE){var k=P.getType(m),H=P.getValue(m);if(H&&H.$changes&&!v.has(H.$changes)&&(x.push(H.$changes),H.$changes.ensureRefId(),E++),R.op!==t.OPERATION.TOUCH){if(r.is(k))vn(H,k,A,j),oe(i,H.$changes.refId),(R.op&t.OPERATION.ADD)===t.OPERATION.ADD&&this.tryEncodeTypeId(i,k,H.constructor);else if(typeof k=="string")cr(k,i,H,A,j);else{var ye=Y(Object.keys(k)[0]);vn(A["_".concat(j)],ye.constructor,A,j),oe(i,H.$changes.refId)}a&&P.cache(m,i.slice(se))}}}!e&&!a&&P.discard()}return i},r.prototype.encodeAll=function(e){return this.encode(!0,[],e)},r.prototype.applyFilters=function(e,i){var a,h;i===void 0&&(i=!1);for(var v=this,x=new Set,E=or.get(e),U=[this.$changes],P=1,A=[],D=function(M){var I=U[M];if(x.has(I.refId))return"continue";var R=I.ref,m=R instanceof r;Q(A,l),oe(A,I.refId);var j=E.refIds.has(I),se=i||!j;E.addRefId(I);var K=E.containerIndexes.get(I),k=se?Array.from(I.allChanges):Array.from(I.changes.values());if(!i&&m&&R._definition.indexesWithFilters){var H=R._definition.indexesWithFilters;H.forEach(function(ht){!K.has(ht)&&I.allChanges.has(ht)&&(se?k.push(ht):k.push({op:t.OPERATION.ADD,index:ht}))})}for(var ye=0,we=k.length;ye<we;ye++){var he=se?{op:t.OPERATION.ADD,index:k[ye]}:k[ye];if(he.op===t.OPERATION.CLEAR){Q(A,he.op);continue}var ee=he.index;if(he.op===t.OPERATION.DELETE){m?Q(A,he.op|ee):(Q(A,he.op),oe(A,ee));continue}var G=I.getValue(ee),ut=I.getType(ee);if(m){var _e=R._definition.filters&&R._definition.filters[ee];if(_e&&!_e.call(R,e,G,v)){G&&G.$changes&&x.add(G.$changes.refId);continue}}else{var Ft=I.parent,_e=I.getChildrenFilter();if(_e&&!_e.call(Ft,e,R.$indexes.get(ee),G,v)){G&&G.$changes&&x.add(G.$changes.refId);continue}}if(G.$changes&&(U.push(G.$changes),P++),he.op!==t.OPERATION.TOUCH)if(he.op===t.OPERATION.ADD||m)A.push.apply(A,(a=I.caches[ee])!==null&&a!==void 0?a:[]),K.add(ee);else if(K.has(ee))A.push.apply(A,(h=I.caches[ee])!==null&&h!==void 0?h:[]);else{if(K.add(ee),Q(A,t.OPERATION.ADD),oe(A,ee),R instanceof C){var $e=I.ref.$indexes.get(ee);ct(A,$e)}G.$changes?oe(A,G.$changes.refId):kt[ut](A,G)}else if(G.$changes&&!m){if(Q(A,t.OPERATION.ADD),oe(A,ee),R instanceof C){var $e=I.ref.$indexes.get(ee);ct(A,$e)}oe(A,G.$changes.refId)}}},O=0;O<P;O++)D(O);return A},r.prototype.clone=function(){var e,i=new this.constructor,a=this._definition.schema;for(var h in a)typeof this[h]=="object"&&typeof((e=this[h])===null||e===void 0?void 0:e.clone)=="function"?i[h]=this[h].clone():i[h]=this[h];return i},r.prototype.toJSON=function(){var e=this._definition.schema,i=this._definition.deprecated,a={};for(var h in e)!i[h]&&this[h]!==null&&typeof this[h]<"u"&&(a[h]=typeof this[h].toJSON=="function"?this[h].toJSON():this["_".concat(h)]);return a},r.prototype.discardAllChanges=function(){this.$changes.discardAll()},r.prototype.getByIndex=function(e){return this[this._definition.fieldsByIndex[e]]},r.prototype.deleteByIndex=function(e){this[this._definition.fieldsByIndex[e]]=void 0},r.prototype.tryEncodeTypeId=function(e,i,a){i._typeid!==a._typeid&&(Q(e,d),oe(e,a._typeid))},r.prototype.getSchemaType=function(e,i,a){var h;return e[i.offset]===d&&(i.offset++,h=this.constructor._context.get(Ce(e,i))),h||a},r.prototype.createTypeInstance=function(e){var i=new e;return i.$changes.root=this.$changes.root,i},r.prototype._triggerChanges=function(e){for(var i,a,h,v,x,E,U,P,A,D=new Set,O=this.$changes.root.refs,M=function(R){var m=e[R],j=m.refId,se=O.get(j),K=se.$callbacks;if((m.op&t.OPERATION.DELETE)===t.OPERATION.DELETE&&m.previousValue instanceof r&&((a=(i=m.previousValue.$callbacks)===null||i===void 0?void 0:i[t.OPERATION.DELETE])===null||a===void 0||a.forEach(function(k){return k()})),!K)return"continue";if(se instanceof r){if(!D.has(j))try{(h=K==null?void 0:K[t.OPERATION.REPLACE])===null||h===void 0||h.forEach(function(k){return k()})}catch(k){r.onError(k)}try{K.hasOwnProperty(m.field)&&((v=K[m.field])===null||v===void 0||v.forEach(function(k){return k(m.value,m.previousValue)}))}catch(k){r.onError(k)}}else m.op===t.OPERATION.ADD&&m.previousValue===void 0?(x=K[t.OPERATION.ADD])===null||x===void 0||x.forEach(function(k){var H;return k(m.value,(H=m.dynamicIndex)!==null&&H!==void 0?H:m.field)}):m.op===t.OPERATION.DELETE?m.previousValue!==void 0&&((E=K[t.OPERATION.DELETE])===null||E===void 0||E.forEach(function(k){var H;return k(m.previousValue,(H=m.dynamicIndex)!==null&&H!==void 0?H:m.field)})):m.op===t.OPERATION.DELETE_AND_ADD&&(m.previousValue!==void 0&&((U=K[t.OPERATION.DELETE])===null||U===void 0||U.forEach(function(k){var H;return k(m.previousValue,(H=m.dynamicIndex)!==null&&H!==void 0?H:m.field)})),(P=K[t.OPERATION.ADD])===null||P===void 0||P.forEach(function(k){var H;return k(m.value,(H=m.dynamicIndex)!==null&&H!==void 0?H:m.field)})),m.value!==m.previousValue&&((A=K[t.OPERATION.REPLACE])===null||A===void 0||A.forEach(function(k){var H;return k(m.value,(H=m.dynamicIndex)!==null&&H!==void 0?H:m.field)}));D.add(j)},I=0;I<e.length;I++)M(I)},r._definition=X.create(),r}();function ur(r){for(var e=[r.$changes],i=1,a={},h=a,v=function(E){var U=e[E];U.changes.forEach(function(P){var A=U.ref,D=P.index,O=A._definition?A._definition.fieldsByIndex[D]:A.$indexes.get(D);h[O]=U.getValue(D)})},x=0;x<i;x++)v(x);return a}var Me={context:new J},Ht=function(r){c(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return f([T("string",Me)],e.prototype,"name",void 0),f([T("string",Me)],e.prototype,"type",void 0),f([T("number",Me)],e.prototype,"referencedType",void 0),e}(ue),Bt=function(r){c(e,r);function e(){var i=r!==null&&r.apply(this,arguments)||this;return i.fields=new w,i}return f([T("number",Me)],e.prototype,"id",void 0),f([T([Ht],Me)],e.prototype,"fields",void 0),e}(ue),hr=function(r){c(e,r);function e(){var i=r!==null&&r.apply(this,arguments)||this;return i.types=new w,i}return e.encode=function(i){var a,h=i.constructor,v=new e;v.rootType=h._typeid;var x=function(A,D){for(var O in D){var M=new Ht;M.name=O;var I=void 0;if(typeof D[O]=="string")I=D[O];else{var R=D[O],m=void 0;ue.is(R)?(I="ref",m=D[O]):(I=Object.keys(R)[0],typeof R[I]=="string"?I+=":"+R[I]:m=R[I]),M.referencedType=m?m._typeid:-1}M.type=I,A.fields.push(M)}v.types.push(A)},E=(a=h._context)===null||a===void 0?void 0:a.types;for(var U in E){var P=new Bt;P.id=Number(U),x(P,E[U]._definition.schema)}return v.encodeAll()},e.decode=function(i,a){var h=new J,v=new e;v.decode(i,a);var x=v.types.reduce(function(D,O){var M=function(R){c(m,R);function m(){return R!==null&&R.apply(this,arguments)||this}return m}(ue),I=O.id;return D[I]=M,h.add(M,I),D},{});v.types.forEach(function(D){var O=x[D.id];D.fields.forEach(function(M){var I;if(M.referencedType!==void 0){var R=M.type,m=x[M.referencedType];if(!m){var j=M.type.split(":");R=j[0],m=j[1]}R==="ref"?T(m,{context:h})(O.prototype,M.name):T((I={},I[R]=m,I),{context:h})(O.prototype,M.name)}else T(M.type,{context:h})(O.prototype,M.name)})});var E=x[v.rootType],U=new E;for(var P in E._definition.schema){var A=E._definition.schema[P];typeof A!="string"&&(U[P]=typeof A=="function"?new A:new(Y(Object.keys(A)[0])).constructor)}return U},f([T([Bt],Me)],e.prototype,"types",void 0),f([T("number",Me)],e.prototype,"rootType",void 0),e}(ue);z("map",{constructor:C}),z("array",{constructor:w}),z("set",{constructor:jt}),z("collection",{constructor:Ut}),t.ArraySchema=w,t.CollectionSchema=Ut,t.Context=J,t.MapSchema=C,t.Reflection=hr,t.ReflectionField=Ht,t.ReflectionType=Bt,t.Schema=ue,t.SchemaDefinition=X,t.SetSchema=jt,t.decode=pn,t.defineTypes=ot,t.deprecated=Le,t.dumpChanges=ur,t.encode=kt,t.filter=Z,t.filterChildren=ge,t.hasFilter=de,t.registerType=z,t.type=T})})(Gt,Gt.exports);var Jn=Gt.exports,Vr=V&&V.__createBinding||(Object.create?function(o,n,t,s){s===void 0&&(s=t);var c=Object.getOwnPropertyDescriptor(n,t);(!c||("get"in c?!n.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(o,s,c)}:function(o,n,t,s){s===void 0&&(s=t),o[s]=n[t]}),Kr=V&&V.__setModuleDefault||(Object.create?function(o,n){Object.defineProperty(o,"default",{enumerable:!0,value:n})}:function(o,n){o.default=n}),Yr=V&&V.__importStar||function(o){if(o&&o.__esModule)return o;var n={};if(o!=null)for(var t in o)t!=="default"&&Object.prototype.hasOwnProperty.call(o,t)&&Vr(n,o,t);return Kr(n,o),n};Object.defineProperty(nt,"__esModule",{value:!0});nt.Room=void 0;const $n=Yr(He),Xr=Ot,ne=nn,En=ke,Gr=rt,lt=Be,ae=Jn,xn=At;class rn{constructor(n,t){this.onStateChange=(0,lt.createSignal)(),this.onError=(0,lt.createSignal)(),this.onLeave=(0,lt.createSignal)(),this.onJoin=(0,lt.createSignal)(),this.hasJoined=!1,this.onMessageHandlers=(0,Gr.createNanoEvents)(),this.roomId=null,this.name=n,t&&(this.serializer=new((0,En.getSerializer)("schema")),this.rootSchema=t,this.serializer.state=new t),this.onError((s,c)=>{var f;return(f=console.warn)===null||f===void 0?void 0:f.call(console,`colyseus.js - onError => (${s}) ${c}`)}),this.onLeave(()=>this.removeAllListeners())}get id(){return this.roomId}connect(n,t,s=this){const c=new Xr.Connection;s.connection=c,c.events.onmessage=rn.prototype.onMessageCallback.bind(s),c.events.onclose=function(f){var u;if(!s.hasJoined){(u=console.warn)===null||u===void 0||u.call(console,`Room connection was closed unexpectedly (${f.code}): ${f.reason}`),s.onError.invoke(f.code,f.reason);return}f.code===xn.CloseCode.DEVMODE_RESTART&&t?t():(s.onLeave.invoke(f.code),s.destroy())},c.events.onerror=function(f){var u;(u=console.warn)===null||u===void 0||u.call(console,`Room, onError (${f.code}): ${f.reason}`),s.onError.invoke(f.code,f.reason)},c.connect(n)}leave(n=!0){return new Promise(t=>{this.onLeave(s=>t(s)),this.connection?n?this.connection.send([ne.Protocol.LEAVE_ROOM]):this.connection.close():this.onLeave.invoke(xn.CloseCode.CONSENTED)})}onMessage(n,t){return this.onMessageHandlers.on(this.getMessageHandlerKey(n),t)}send(n,t){const s=[ne.Protocol.ROOM_DATA];typeof n=="string"?ae.encode.string(s,n):ae.encode.number(s,n);let c;if(t!==void 0){const f=$n.encode(t);c=new Uint8Array(s.length+f.byteLength),c.set(new Uint8Array(s),0),c.set(new Uint8Array(f),s.length)}else c=new Uint8Array(s);this.connection.send(c.buffer)}sendBytes(n,t){const s=[ne.Protocol.ROOM_DATA_BYTES];typeof n=="string"?ae.encode.string(s,n):ae.encode.number(s,n);let c;c=new Uint8Array(s.length+(t.byteLength||t.length)),c.set(new Uint8Array(s),0),c.set(new Uint8Array(t),s.length),this.connection.send(c.buffer)}get state(){return this.serializer.getState()}removeAllListeners(){this.onJoin.clear(),this.onStateChange.clear(),this.onError.clear(),this.onLeave.clear(),this.onMessageHandlers.events={}}onMessageCallback(n){const t=Array.from(new Uint8Array(n.data)),s=t[0];if(s===ne.Protocol.JOIN_ROOM){let c=1;const f=(0,ne.utf8Read)(t,c);if(c+=(0,ne.utf8Length)(f),this.serializerId=(0,ne.utf8Read)(t,c),c+=(0,ne.utf8Length)(this.serializerId),!this.serializer){const u=(0,En.getSerializer)(this.serializerId);this.serializer=new u}t.length>c&&this.serializer.handshake&&this.serializer.handshake(t,{offset:c}),this.reconnectionToken=`${this.roomId}:${f}`,this.hasJoined=!0,this.onJoin.invoke(),this.connection.send([ne.Protocol.JOIN_ROOM])}else if(s===ne.Protocol.ERROR){const c={offset:1},f=ae.decode.number(t,c),u=ae.decode.string(t,c);this.onError.invoke(f,u)}else if(s===ne.Protocol.LEAVE_ROOM)this.leave();else if(s===ne.Protocol.ROOM_DATA_SCHEMA){const c={offset:1},u=this.serializer.getState().constructor._context.get(ae.decode.number(t,c)),l=new u;l.decode(t,c),this.dispatchMessage(u,l)}else if(s===ne.Protocol.ROOM_STATE)t.shift(),this.setState(t);else if(s===ne.Protocol.ROOM_STATE_PATCH)t.shift(),this.patch(t);else if(s===ne.Protocol.ROOM_DATA){const c={offset:1},f=ae.decode.stringCheck(t,c)?ae.decode.string(t,c):ae.decode.number(t,c),u=t.length>c.offset?$n.decode(n.data,c.offset):void 0;this.dispatchMessage(f,u)}else if(s===ne.Protocol.ROOM_DATA_BYTES){const c={offset:1},f=ae.decode.stringCheck(t,c)?ae.decode.string(t,c):ae.decode.number(t,c);this.dispatchMessage(f,new Uint8Array(t.slice(c.offset)))}}setState(n){this.serializer.setState(n),this.onStateChange.invoke(this.serializer.getState())}patch(n){this.serializer.patch(n),this.onStateChange.invoke(this.serializer.getState())}dispatchMessage(n,t){var s;const c=this.getMessageHandlerKey(n);this.onMessageHandlers.events[c]?this.onMessageHandlers.emit(c,t):this.onMessageHandlers.events["*"]?this.onMessageHandlers.emit("*",n,t):(s=console.warn)===null||s===void 0||s.call(console,`colyseus.js: onMessage() not registered for type '${n}'.`)}destroy(){this.serializer&&this.serializer.teardown()}getMessageHandlerKey(n){switch(typeof n){case"function":return`$${n._typeid}`;case"string":return n;case"number":return`i${n}`;default:throw new Error("invalid message type.")}}}nt.Room=rn;var St={};function An(o,n){n.headers=o.headers||{},n.statusMessage=o.statusText,n.statusCode=o.status,n.data=o.response}function le(o,n,t){return new Promise(function(s,c){t=t||{};var f=new XMLHttpRequest,u,l,d,g=t.body,p=t.headers||{};t.timeout&&(f.timeout=t.timeout),f.ontimeout=f.onerror=function(_){_.timeout=_.type=="timeout",c(_)},f.open(o,n.href||n),f.onload=function(){for(d=f.getAllResponseHeaders().trim().split(/[\r\n]+/),An(f,f);l=d.shift();)l=l.split(": "),f.headers[l.shift().toLowerCase()]=l.join(": ");if(l=f.headers["content-type"],l&&~l.indexOf("application/json"))try{f.data=JSON.parse(f.data,t.reviver)}catch(_){return An(f,_),c(_)}(f.status>=400?c:s)(f)},typeof FormData<"u"&&g instanceof FormData||g&&typeof g=="object"&&(p["content-type"]="application/json",g=JSON.stringify(g)),f.withCredentials=!!t.withCredentials;for(u in p)f.setRequestHeader(u,p[u]);f.send(g)})}var Zr=le.bind(le,"GET"),Qr=le.bind(le,"POST"),ei=le.bind(le,"PATCH"),ti=le.bind(le,"DELETE"),ni=le.bind(le,"PUT");const ri=Object.freeze(Object.defineProperty({__proto__:null,del:ti,get:Zr,patch:ei,post:Qr,put:ni,send:le},Symbol.toStringTag,{value:"Module"})),ii=Tr(ri);var oi=V&&V.__createBinding||(Object.create?function(o,n,t,s){s===void 0&&(s=t);var c=Object.getOwnPropertyDescriptor(n,t);(!c||("get"in c?!n.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(o,s,c)}:function(o,n,t,s){s===void 0&&(s=t),o[s]=n[t]}),si=V&&V.__setModuleDefault||(Object.create?function(o,n){Object.defineProperty(o,"default",{enumerable:!0,value:n})}:function(o,n){o.default=n}),ai=V&&V.__importStar||function(o){if(o&&o.__esModule)return o;var n={};if(o!=null)for(var t in o)t!=="default"&&Object.prototype.hasOwnProperty.call(o,t)&&oi(n,o,t);return si(n,o),n};Object.defineProperty(St,"__esModule",{value:!0});St.HTTP=void 0;const ci=At,fi=ai(ii);class ui{constructor(n){this.client=n}get(n,t={}){return this.request("get",n,t)}post(n,t={}){return this.request("post",n,t)}del(n,t={}){return this.request("del",n,t)}put(n,t={}){return this.request("put",n,t)}request(n,t,s={}){return fi[n](this.client.getHttpEndpoint(t),this.getOptions(s)).catch(c=>{var f;const u=c.statusCode,l=((f=c.data)===null||f===void 0?void 0:f.error)||c.statusMessage||c.message;throw!u&&!l?c:new ci.ServerError(u,l)})}getOptions(n){return this.authToken&&(n.headers||(n.headers={}),n.headers.Authorization=`Bearer ${this.authToken}`),typeof cc<"u"&&cc.sys&&cc.sys.isNative||(n.withCredentials=!0),n}}St.HTTP=ui;var it={},Se={};Object.defineProperty(Se,"__esModule",{value:!0});Se.getItem=Se.removeItem=Se.setItem=void 0;let Ze;function on(){if(!Ze)try{Ze=typeof cc<"u"&&cc.sys&&cc.sys.localStorage?cc.sys.localStorage:window.localStorage}catch{}return Ze||(Ze={cache:{},setItem:function(o,n){this.cache[o]=n},getItem:function(o){this.cache[o]},removeItem:function(o){delete this.cache[o]}}),Ze}function hi(o,n){on().setItem(o,n)}Se.setItem=hi;function li(o){on().removeItem(o)}Se.removeItem=li;function di(o,n){const t=on().getItem(o);typeof Promise>"u"||!(t instanceof Promise)?n(t):t.then(s=>n(s))}Se.getItem=di;var Pe=V&&V.__awaiter||function(o,n,t,s){function c(f){return f instanceof t?f:new t(function(u){u(f)})}return new(t||(t=Promise))(function(f,u){function l(p){try{g(s.next(p))}catch(_){u(_)}}function d(p){try{g(s.throw(p))}catch(_){u(_)}}function g(p){p.done?f(p.value):c(p.value).then(l,d)}g((s=s.apply(o,n||[])).next())})},Ue=V&&V.__classPrivateFieldGet||function(o,n,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?o!==n||!s:!n.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(o):s?s.value:n.get(o)},Qe=V&&V.__classPrivateFieldSet||function(o,n,t,s,c){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!c)throw new TypeError("Private accessor was defined without a setter");if(typeof n=="function"?o!==n||!c:!n.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?c.call(o,t):c?c.value=t:n.set(o,t),t},gt,Zt,Ee,mt;Object.defineProperty(it,"__esModule",{value:!0});it.Auth=void 0;const Yt=Se,pi=rt;class vi{constructor(n){this.http=n,this.settings={path:"/auth",key:"colyseus-auth-token"},gt.set(this,!1),Zt.set(this,void 0),Ee.set(this,void 0),mt.set(this,(0,pi.createNanoEvents)()),(0,Yt.getItem)(this.settings.key,t=>this.token=t)}set token(n){this.http.authToken=n}get token(){return this.http.authToken}onChange(n){const t=Ue(this,mt,"f").on("change",n);return Ue(this,gt,"f")||Qe(this,Zt,new Promise((s,c)=>{this.getUserData().then(f=>{this.emitChange(Object.assign(Object.assign({},f),{token:this.token}))}).catch(f=>{this.emitChange({user:null,token:void 0})}).finally(()=>{s()})}),"f"),Qe(this,gt,!0,"f"),t}getUserData(){return Pe(this,void 0,void 0,function*(){if(this.token)return(yield this.http.get(`${this.settings.path}/userdata`)).data;throw new Error("missing auth.token")})}registerWithEmailAndPassword(n,t,s){return Pe(this,void 0,void 0,function*(){const c=(yield this.http.post(`${this.settings.path}/register`,{body:{email:n,password:t,options:s}})).data;return this.emitChange(c),c})}signInWithEmailAndPassword(n,t){return Pe(this,void 0,void 0,function*(){const s=(yield this.http.post(`${this.settings.path}/login`,{body:{email:n,password:t}})).data;return this.emitChange(s),s})}signInAnonymously(n){return Pe(this,void 0,void 0,function*(){const t=(yield this.http.post(`${this.settings.path}/anonymous`,{body:{options:n}})).data;return this.emitChange(t),t})}sendPasswordResetEmail(n){return Pe(this,void 0,void 0,function*(){return(yield this.http.post(`${this.settings.path}/forgot-password`,{body:{email:n}})).data})}signInWithProvider(n,t={}){return Pe(this,void 0,void 0,function*(){return new Promise((s,c)=>{const f=t.width||480,u=t.height||768,l=this.token?`?token=${this.token}`:"",d=`Login with ${n[0].toUpperCase()+n.substring(1)}`,g=this.http.client.getHttpEndpoint(`${t.prefix||`${this.settings.path}/provider`}/${n}${l}`),p=screen.width/2-f/2,_=screen.height/2-u/2;Qe(this,Ee,window.open(g,d,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+f+", height="+u+", top="+_+", left="+p),"f");const y=S=>{S.data.user===void 0&&S.data.token===void 0||(clearInterval(b),Ue(this,Ee,"f").close(),Qe(this,Ee,void 0,"f"),window.removeEventListener("message",y),S.data.error!==void 0?c(S.data.error):(s(S.data),this.emitChange(S.data)))},b=setInterval(()=>{(!Ue(this,Ee,"f")||Ue(this,Ee,"f").closed)&&(Qe(this,Ee,void 0,"f"),c("cancelled"),window.removeEventListener("message",y))},200);window.addEventListener("message",y)})})}signOut(){return Pe(this,void 0,void 0,function*(){this.emitChange({user:null,token:null})})}emitChange(n){n.token!==void 0&&(this.token=n.token,n.token===null?(0,Yt.removeItem)(this.settings.key):(0,Yt.setItem)(this.settings.key,n.token)),Ue(this,mt,"f").emit("change",n)}}it.Auth=vi;gt=new WeakMap,Zt=new WeakMap,Ee=new WeakMap,mt=new WeakMap;var It={};Object.defineProperty(It,"__esModule",{value:!0});It.discordURLBuilder=void 0;function gi(o){var n;const t=((n=window==null?void 0:window.location)===null||n===void 0?void 0:n.hostname)||"localhost",s=o.hostname.split("."),c=!o.hostname.includes("trycloudflare.com")&&!o.hostname.includes("discordsays.com")&&s.length>2?`/${s[0]}`:"";return o.pathname.startsWith("/.proxy")?`${o.protocol}//${t}${c}${o.pathname}${o.search}`:`${o.protocol}//${t}/.proxy/colyseus${c}${o.pathname}${o.search}`}It.discordURLBuilder=gi;var ve=V&&V.__awaiter||function(o,n,t,s){function c(f){return f instanceof t?f:new t(function(u){u(f)})}return new(t||(t=Promise))(function(f,u){function l(p){try{g(s.next(p))}catch(_){u(_)}}function d(p){try{g(s.throw(p))}catch(_){u(_)}}function g(p){p.done?f(p.value):c(p.value).then(l,d)}g((s=s.apply(o,n||[])).next())})},Xt;Object.defineProperty(ze,"__esModule",{value:!0});ze.Client=ze.MatchMakeError=void 0;const mi=At,_i=nt,yi=St,wi=it,$i=It;class Tt extends Error{constructor(n,t){super(n),this.code=t,Object.setPrototypeOf(this,Tt.prototype)}}ze.MatchMakeError=Tt;const On=typeof window<"u"&&typeof((Xt=window==null?void 0:window.location)===null||Xt===void 0?void 0:Xt.hostname)<"u"?`${window.location.protocol.replace("http","ws")}//${window.location.hostname}${window.location.port&&`:${window.location.port}`}`:"ws://127.0.0.1:2567";class Ei{constructor(n=On,t){var s,c;if(typeof n=="string"){const f=n.startsWith("/")?new URL(n,On):new URL(n),u=f.protocol==="https:"||f.protocol==="wss:",l=Number(f.port||(u?443:80));this.settings={hostname:f.hostname,pathname:f.pathname,port:l,secure:u}}else n.port===void 0&&(n.port=n.secure?443:80),n.pathname===void 0&&(n.pathname=""),this.settings=n;this.settings.pathname.endsWith("/")&&(this.settings.pathname=this.settings.pathname.slice(0,-1)),this.http=new yi.HTTP(this),this.auth=new wi.Auth(this.http),this.urlBuilder=t,!this.urlBuilder&&typeof window<"u"&&(!((c=(s=window==null?void 0:window.location)===null||s===void 0?void 0:s.hostname)===null||c===void 0)&&c.includes("discordsays.com"))&&(this.urlBuilder=$i.discordURLBuilder,console.log("Colyseus SDK: Discord Embedded SDK detected. Using custom URL builder."))}joinOrCreate(n,t={},s){return ve(this,void 0,void 0,function*(){return yield this.createMatchMakeRequest("joinOrCreate",n,t,s)})}create(n,t={},s){return ve(this,void 0,void 0,function*(){return yield this.createMatchMakeRequest("create",n,t,s)})}join(n,t={},s){return ve(this,void 0,void 0,function*(){return yield this.createMatchMakeRequest("join",n,t,s)})}joinById(n,t={},s){return ve(this,void 0,void 0,function*(){return yield this.createMatchMakeRequest("joinById",n,t,s)})}reconnect(n,t){return ve(this,void 0,void 0,function*(){if(typeof n=="string"&&typeof t=="string")throw new Error("DEPRECATED: .reconnect() now only accepts 'reconnectionToken' as argument.\nYou can get this token from previously connected `room.reconnectionToken`");const[s,c]=n.split(":");if(!s||!c)throw new Error(`Invalid reconnection token format.
The format should be roomId:reconnectionToken`);return yield this.createMatchMakeRequest("reconnect",s,{reconnectionToken:c},t)})}getAvailableRooms(n=""){return ve(this,void 0,void 0,function*(){return(yield this.http.get(`matchmake/${n}`,{headers:{Accept:"application/json"}})).data})}consumeSeatReservation(n,t,s){return ve(this,void 0,void 0,function*(){const c=this.createRoom(n.room.name,t);c.roomId=n.room.roomId,c.sessionId=n.sessionId;const f={sessionId:c.sessionId};n.reconnectionToken&&(f.reconnectionToken=n.reconnectionToken);const u=s||c;return c.connect(this.buildEndpoint(n.room,f),n.devMode&&(()=>ve(this,void 0,void 0,function*(){console.info(`[Colyseus devMode]: ${String.fromCodePoint(128260)} Re-establishing connection with room id '${c.roomId}'...`);let l=0,d=8;const g=()=>ve(this,void 0,void 0,function*(){l++;try{yield this.consumeSeatReservation(n,t,u),console.info(`[Colyseus devMode]: ${String.fromCodePoint(9989)} Successfully re-established connection with room '${c.roomId}'`)}catch{l<d?(console.info(`[Colyseus devMode]: ${String.fromCodePoint(128260)} retrying... (${l} out of ${d})`),setTimeout(g,2e3)):console.info(`[Colyseus devMode]: ${String.fromCodePoint(10060)} Failed to reconnect. Is your server running? Please check server logs.`)}});setTimeout(g,2e3)})),u),new Promise((l,d)=>{const g=(p,_)=>d(new mi.ServerError(p,_));u.onError.once(g),u.onJoin.once(()=>{u.onError.remove(g),l(u)})})})}createMatchMakeRequest(n,t,s={},c,f){return ve(this,void 0,void 0,function*(){const u=(yield this.http.post(`matchmake/${n}/${t}`,{headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)})).data;if(u.error)throw new Tt(u.error,u.code);return n==="reconnect"&&(u.reconnectionToken=s.reconnectionToken),yield this.consumeSeatReservation(u,c,f)})}createRoom(n,t){return new _i.Room(n,t)}buildEndpoint(n,t={}){const s=[];for(const u in t)t.hasOwnProperty(u)&&s.push(`${u}=${t[u]}`);let c=this.settings.secure?"wss://":"ws://";n.publicAddress?c+=`${n.publicAddress}`:c+=`${this.settings.hostname}${this.getEndpointPort()}${this.settings.pathname}`;const f=`${c}/${n.processId}/${n.roomId}?${s.join("&")}`;return this.urlBuilder?this.urlBuilder(new URL(f)):f}getHttpEndpoint(n=""){const t=n.startsWith("/")?n:`/${n}`,s=`${this.settings.secure?"https":"http"}://${this.settings.hostname}${this.getEndpointPort()}${this.settings.pathname}${t}`;return this.urlBuilder?this.urlBuilder(new URL(s)):s}getEndpointPort(){return this.settings.port!==80&&this.settings.port!==443?`:${this.settings.port}`:""}}ze.Client=Ei;var Rt={};Object.defineProperty(Rt,"__esModule",{value:!0});Rt.SchemaSerializer=void 0;const bn=Jn;class xi{setState(n){return this.state.decode(n)}getState(){return this.state}patch(n){return this.state.decode(n)}teardown(){var n,t;(t=(n=this.state)===null||n===void 0?void 0:n.$changes)===null||t===void 0||t.root.clearRefs()}handshake(n,t){this.state?new bn.Reflection().decode(n,t):this.state=bn.Reflection.decode(n,t)}}Rt.SchemaSerializer=xi;var Ct={};Object.defineProperty(Ct,"__esModule",{value:!0});Ct.NoneSerializer=void 0;class Ai{setState(n){}getState(){return null}patch(n){}teardown(){}handshake(n){}}Ct.NoneSerializer=Ai;(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.SchemaSerializer=o.registerSerializer=o.Auth=o.Room=o.ErrorCode=o.Protocol=o.Client=void 0;var n=ze;Object.defineProperty(o,"Client",{enumerable:!0,get:function(){return n.Client}});var t=nn;Object.defineProperty(o,"Protocol",{enumerable:!0,get:function(){return t.Protocol}}),Object.defineProperty(o,"ErrorCode",{enumerable:!0,get:function(){return t.ErrorCode}});var s=nt;Object.defineProperty(o,"Room",{enumerable:!0,get:function(){return s.Room}});var c=it;Object.defineProperty(o,"Auth",{enumerable:!0,get:function(){return c.Auth}});const f=Rt;Object.defineProperty(o,"SchemaSerializer",{enumerable:!0,get:function(){return f.SchemaSerializer}});const u=Ct,l=ke;Object.defineProperty(o,"registerSerializer",{enumerable:!0,get:function(){return l.registerSerializer}}),(0,l.registerSerializer)("schema",f.SchemaSerializer),(0,l.registerSerializer)("none",u.NoneSerializer)})(Hn);const Oi="wss://p01--unonche-server--6x9xdhvfh6lk.code.run",sn=new Hn.Client(Oi),Mt=Ie(null),Qt=Ie([]),et=Ie(null),Wn=async o=>{dr(`?room=${o.roomId}`),bi(o)},bi=o=>{o.onStateChange(n=>{et.set(n)}),o.onMessage("chat_msg",n=>{et&&Qt.update(t=>{var s,c;return[...t,{playerName:(c=(s=wt(et))==null?void 0:s.players.get(n.playerId))==null?void 0:c.name,text:n.text}]})})},Yi=async(o,n)=>{try{const t=await sn.create("uno_room",{name:o,avatar:n});Mt.set(t),await Wn(t)}catch(t){console.error("Error joining room:",t)}},Xi=async(o,n,t)=>{if(!await Si(o))throw Error("Cette room n'existe pas, qu'est-ce que tu branle khey ?");try{const s=await sn.joinById(o,{name:n,avatar:t});Mt.set(s),await Wn(s)}catch(s){console.error("Error joining room:",s)}},Gi=()=>{Mt.update(o=>(o&&o.leave(),null))},Si=async o=>{try{return(await sn.getAvailableRooms("uno_room")).some(s=>s.roomId===o)}catch(n){return console.error("Error checking room existence:",n),!1}},Zi=o=>{const n=o||Object.fromEntries(wt(et).players),t=new Map;for(const[s,c]of Object.entries(n))c.spectator||t.set(s,c);return t};function Sn(o,n,t){const s=o.slice();return s[7]=n[t],s}function Ii(o){let n,t=o[7].text+"",s;return{c(){n=W("i"),s=Oe(t)},l(c){n=q(c,"I",{});var f=re(n);s=be(f,t),f.forEach(F)},m(c,f){ie(c,n,f),B(n,s)},p(c,f){f&2&&t!==(t=c[7].text+"")&&tt(s,t)},d(c){c&&F(n)}}}function Ti(o){let n,t=o[7].playerName+"",s,c,f=o[7].text+"",u;return{c(){n=W("span"),s=Oe(t),c=Oe(": "),u=Oe(f),this.h()},l(l){n=q(l,"SPAN",{class:!0});var d=re(n);s=be(d,t),d.forEach(F),c=be(l,": "),u=be(l,f),this.h()},h(){L(n,"class","text-red-500")},m(l,d){ie(l,n,d),B(n,s),ie(l,c,d),ie(l,u,d)},p(l,d){d&2&&t!==(t=l[7].playerName+"")&&tt(s,t),d&2&&f!==(f=l[7].text+"")&&tt(u,f)},d(l){l&&(F(n),F(c),F(u))}}}function In(o){let n,t;function s(u,l){return u[7].playerName?Ti:Ii}let c=s(o),f=c(o);return{c(){n=W("div"),f.c(),t=ce(),this.h()},l(u){n=q(u,"DIV",{class:!0});var l=re(n);f.l(l),t=fe(l),l.forEach(F),this.h()},h(){L(n,"class","break-words")},m(u,l){ie(u,n,l),f.m(n,null),B(n,t)},p(u,l){c===(c=s(u))&&f?f.p(u,l):(f.d(1),f=c(u),f&&(f.c(),f.m(n,t)))},d(u){u&&F(n),f.d()}}}function Ri(o){let n,t,s,c,f,u,l,d='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6"><path d="M3.478 2.404a.75.75 0 0 0-.926.941l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.986.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.404Z"></path></svg>',g,p,_=yt(o[1]),y=[];for(let b=0;b<_.length;b+=1)y[b]=In(Sn(o,_,b));return{c(){n=W("div"),t=W("div");for(let b=0;b<y.length;b+=1)y[b].c();s=ce(),c=W("div"),f=W("input"),u=ce(),l=W("button"),l.innerHTML=d,this.h()},l(b){n=q(b,"DIV",{class:!0});var S=re(n);t=q(S,"DIV",{id:!0,class:!0,style:!0});var w=re(t);for(let C=0;C<y.length;C+=1)y[C].l(w);w.forEach(F),s=fe(S),c=q(S,"DIV",{class:!0});var $=re(c);f=q($,"INPUT",{class:!0,type:!0,placeholder:!0}),u=fe($),l=q($,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),De(l)!=="svelte-yp6g7y"&&(l.innerHTML=d),$.forEach(F),S.forEach(F),this.h()},h(){L(t,"id","chat-box"),L(t,"class","mt-auto mb-4 overflow-y-auto"),Ae(t,"flex-grow","0"),Ae(t,"flex-shrink","1"),L(f,"class","input mr-2"),L(f,"type","text"),L(f,"placeholder","Message..."),L(l,"type","button"),L(l,"class","btn-icon btn-icon-md variant-filled rounded-lg shrink-0"),L(c,"class","flex"),L(n,"class","h-full min-h-0 flex flex-col p-4")},m(b,S){ie(b,n,S),B(n,t);for(let w=0;w<y.length;w+=1)y[w]&&y[w].m(t,null);B(n,s),B(n,c),B(c,f),gn(f,o[0]),B(c,u),B(c,l),g||(p=[dt(f,"input",o[4]),dt(f,"keydown",o[3]),dt(l,"click",o[2])],g=!0)},p(b,[S]){if(S&2){_=yt(b[1]);let w;for(w=0;w<_.length;w+=1){const $=Sn(b,_,w);y[w]?y[w].p($,S):(y[w]=In($),y[w].c(),y[w].m(t,null))}for(;w<y.length;w+=1)y[w].d(1);y.length=_.length}S&1&&f.value!==b[0]&&gn(f,b[0])},i:xe,o:xe,d(b){b&&F(n),Nn(y,b),g=!1,en(p)}}}function Ci(o,n,t){let s,c,f;_t(o,Mt,p=>t(5,c=p)),_t(o,Qt,p=>t(1,f=p));function u(){s.trim().length!==0&&(c.send("chat_msg",{text:s.trim()}),t(0,s=""))}function l(p){p.key==="Enter"&&(u(),p.preventDefault())}gr(()=>d());const d=async()=>{const p=document.getElementById("chat-box");p&&p.scroll({top:p.scrollHeight,behavior:"smooth"})};Qt.subscribe(async()=>{const p=document.getElementById("chat-box");p&&Math.abs(p.scrollHeight-p.scrollTop-p.clientHeight)<100&&(await mr(),d())});function g(){s=this.value,t(0,s)}return t(0,s=""),[s,f,u,l,g]}class Mi extends Et{constructor(n){super(),xt(this,n,Ci,Ri,$t,{})}}function Tn(o,n,t){const s=o.slice();return s[1]=n[t],s}function Rn(o){let n,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6"><path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"></path><path fill-rule="evenodd" d="M1.323 11.447C2.811 6.976 7.028 3.75 12.001 3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 0-9.186-3.223-10.675-7.69a1.762 1.762 0 0 1 0-1.113ZM17.25 12a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Z" clip-rule="evenodd"></path></svg>';return{c(){n=W("span"),n.innerHTML=t,this.h()},l(s){n=q(s,"SPAN",{class:!0,style:!0,"data-svelte-h":!0}),De(n)!=="svelte-uxp51x"&&(n.innerHTML=t),this.h()},h(){L(n,"class","badge-icon variant-filled opacity-50 absolute z-10"),Ae(n,"top","-5px"),Ae(n,"right","-5px"),Ae(n,"padding","2px")},m(s,c){ie(s,n,c)},d(s){s&&F(n)}}}function Cn(o){let n,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M576 136c0 22.09-17.91 40-40 40c-.248 0-.4551-.1266-.7031-.1305l-50.52 277.9C482 468.9 468.8 480 453.3 480H122.7c-15.46 0-28.72-11.06-31.48-26.27L40.71 175.9C40.46 175.9 40.25 176 39.1 176c-22.09 0-40-17.91-40-40S17.91 96 39.1 96s40 17.91 40 40c0 8.998-3.521 16.89-8.537 23.57l89.63 71.7c15.91 12.73 39.5 7.544 48.61-10.68l57.6-115.2C255.1 98.34 247.1 86.34 247.1 72C247.1 49.91 265.9 32 288 32s39.1 17.91 39.1 40c0 14.34-7.963 26.34-19.3 33.4l57.6 115.2c9.111 18.22 32.71 23.4 48.61 10.68l89.63-71.7C499.5 152.9 496 144.1 496 136C496 113.9 513.9 96 536 96S576 113.9 576 136z"></path></svg>';return{c(){n=W("span"),n.innerHTML=t,this.h()},l(s){n=q(s,"SPAN",{class:!0,style:!0,"data-svelte-h":!0}),De(n)!=="svelte-19a6q47"&&(n.innerHTML=t),this.h()},h(){L(n,"class","badge-icon bg-amber-400 opacity-50 absolute z-10"),Ae(n,"top","-5px"),Ae(n,"right","-5px"),Ae(n,"padding","3px")},m(s,c){ie(s,n,c)},d(s){s&&F(n)}}}function Mn(o){let n,t,s=o[1].handSize+"",c,f;return{c(){n=W("span"),t=Oe("- "),c=Oe(s),f=Oe(" cartes"),this.h()},l(u){n=q(u,"SPAN",{class:!0});var l=re(n);t=be(l,"- "),c=be(l,s),f=be(l," cartes"),l.forEach(F),this.h()},h(){L(n,"class","ml-1")},m(u,l){ie(u,n,l),B(n,t),B(n,c),B(n,f)},p(u,l){l&1&&s!==(s=u[1].handSize+"")&&tt(c,s)},d(u){u&&F(n)}}}function Pn(o){let n,t,s,c,f,u,l,d,g,p,_=o[1].name+"",y,b,S,w=o[1].spectator&&Rn(),$=o[0].kingPlayerId===o[1].id&&Cn(),C=!o[1].spectator&&o[0].playing&&Mn(o);return{c(){n=W("li"),t=W("div"),s=W("img"),l=ce(),w&&w.c(),d=ce(),$&&$.c(),g=ce(),p=W("span"),y=Oe(_),b=ce(),C&&C.c(),S=ce(),this.h()},l(N){n=q(N,"LI",{class:!0});var z=re(n);t=q(z,"DIV",{class:!0});var Y=re(t);s=q(Y,"IMG",{src:!0,alt:!0,width:!0,class:!0}),l=fe(Y),w&&w.l(Y),d=fe(Y),$&&$.l(Y),Y.forEach(F),g=fe(z),p=q(z,"SPAN",{});var X=re(p);y=be(X,_),X.forEach(F),b=fe(z),C&&C.l(z),S=fe(z),z.forEach(F),this.h()},h(){mn(s.src,c="avatars/"+o[1].avatar+".png")||L(s,"src",c),L(s,"alt",f=o[1].avatar),L(s,"width","36px"),L(s,"class",u="rounded-full border-2 "+(o[1].id===o[0].currentPlayerId?"border-red-500":"border-transparent")),pe(s,"grayscale",o[1].spectator),L(t,"class","relative inline-block mr-2"),pe(p,"text-slate-500",o[1].spectator),pe(p,"text-red-500",!o[1].spectator),L(n,"class","border-l-2 px-4 py-2 flex items-center"),pe(n,"border-red-500",o[1].id===o[0].currentPlayerId),pe(n,"border-transparent",o[1].id!==o[0].currentPlayerId)},m(N,z){ie(N,n,z),B(n,t),B(t,s),B(t,l),w&&w.m(t,null),B(t,d),$&&$.m(t,null),B(n,g),B(n,p),B(p,y),B(n,b),C&&C.m(n,null),B(n,S)},p(N,z){z&1&&!mn(s.src,c="avatars/"+N[1].avatar+".png")&&L(s,"src",c),z&1&&f!==(f=N[1].avatar)&&L(s,"alt",f),z&1&&u!==(u="rounded-full border-2 "+(N[1].id===N[0].currentPlayerId?"border-red-500":"border-transparent"))&&L(s,"class",u),z&1&&pe(s,"grayscale",N[1].spectator),N[1].spectator?w||(w=Rn(),w.c(),w.m(t,d)):w&&(w.d(1),w=null),N[0].kingPlayerId===N[1].id?$||($=Cn(),$.c(),$.m(t,null)):$&&($.d(1),$=null),z&1&&_!==(_=N[1].name+"")&&tt(y,_),z&1&&pe(p,"text-slate-500",N[1].spectator),z&1&&pe(p,"text-red-500",!N[1].spectator),!N[1].spectator&&N[0].playing?C?C.p(N,z):(C=Mn(N),C.c(),C.m(n,S)):C&&(C.d(1),C=null),z&1&&pe(n,"border-red-500",N[1].id===N[0].currentPlayerId),z&1&&pe(n,"border-transparent",N[1].id!==N[0].currentPlayerId)},d(N){N&&F(n),w&&w.d(),$&&$.d(),C&&C.d()}}}function Pi(o){let n,t,s=yt(o[0].players.values()),c=[];for(let f=0;f<s.length;f+=1)c[f]=Pn(Tn(o,s,f));return{c(){n=W("div"),t=W("ul");for(let f=0;f<c.length;f+=1)c[f].c();this.h()},l(f){n=q(f,"DIV",{class:!0});var u=re(n);t=q(u,"UL",{});var l=re(t);for(let d=0;d<c.length;d+=1)c[d].l(l);l.forEach(F),u.forEach(F),this.h()},h(){L(n,"class","h-full flex flex-col py-2 card rounded-none")},m(f,u){ie(f,n,u),B(n,t);for(let l=0;l<c.length;l+=1)c[l]&&c[l].m(t,null)},p(f,[u]){if(u&1){s=yt(f[0].players.values());let l;for(l=0;l<s.length;l+=1){const d=Tn(f,s,l);c[l]?c[l].p(d,u):(c[l]=Pn(d),c[l].c(),c[l].m(t,null))}for(;l<c.length;l+=1)c[l].d(1);c.length=s.length}},i:xe,o:xe,d(f){f&&F(n),Nn(c,f)}}}function Di(o,n,t){let s;return _t(o,et,c=>t(0,s=c)),[s]}class ki extends Et{constructor(n){super(),xt(this,n,Di,Pi,$t,{})}}function Li(o){let n,t,s,c,f,u,l,d,g;return s=new Ir({}),s.$on("openHelp",o[1]),u=new ki({}),d=new Mi({}),{c(){n=W("div"),t=W("div"),Jt(s.$$.fragment),c=ce(),f=W("div"),Jt(u.$$.fragment),l=ce(),Jt(d.$$.fragment),this.h()},l(p){n=q(p,"DIV",{class:!0});var _=re(n);t=q(_,"DIV",{class:!0});var y=re(t);Wt(s.$$.fragment,y),y.forEach(F),c=fe(_),f=q(_,"DIV",{class:!0});var b=re(f);Wt(u.$$.fragment,b),b.forEach(F),l=fe(_),Wt(d.$$.fragment,_),_.forEach(F),this.h()},h(){L(t,"class","h-auto z-40"),L(f,"class","h-auto"),L(n,"class","flex flex-col card rounded-nonei w-full h-full")},m(p,_){ie(p,n,_),B(n,t),qt(s,t,null),B(n,c),B(n,f),qt(u,f,null),B(n,l),qt(d,n,null),g=!0},p:xe,i(p){g||(pt(s.$$.fragment,p),pt(u.$$.fragment,p),pt(d.$$.fragment,p),g=!0)},o(p){vt(s.$$.fragment,p),vt(u.$$.fragment,p),vt(d.$$.fragment,p),g=!1},d(p){p&&F(n),Vt(s),Vt(u),Vt(d)}}}function Ni(o){const n=Ln();return[n,()=>n("openHelp")]}class Qi extends Et{constructor(n){super(),xt(this,n,Ni,Li,$t,{})}}export{Qi as L,Ji as a,Wi as b,Yi as c,Ki as d,yt as e,Hi as f,Fi as g,yn as h,qi as i,Xi as j,et as k,bi as l,Zi as m,Gi as n,Vi as p,Mt as r,yr as s,Bi as u};
